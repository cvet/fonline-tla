{
  "$type": "Screen",
  "IsModal": false,
  "IsMultiinstance": false,
  "IsCloseOnMiss": false,
  "AvailableCursors": null,
  "IsCanMove": true,
  "IsMoveIgnoreBorders": false,
  "BackgroundImage": null,
  "BackgroundImageLayout": "None",
  "CropContent": false,
  "IsVerticalScroll": false,
  "IsHorizontalScroll": false,
  "Expanded": true,
  "Selected": false,
  "Active": true,
  "Name": "Screen",
  "Position": "0, 0",
  "Size": "0, 0",
  "Anchor": "None",
  "Dock": "None",
  "IsDraggable": false,
  "IsNotHittable": false,
  "CheckTransparentOnHit": false,
  "GlobalScope": null,
  "ClassFields": null,
  "OnInit": null,
  "OnShow": null,
  "OnHide": null,
  "OnAppear": null,
  "OnDisappear": null,
  "OnDraw": null,
  "OnPostDraw": null,
  "OnMove": null,
  "OnMouseDown": null,
  "OnMouseUp": null,
  "OnMousePressed": null,
  "OnLMousePressed": null,
  "OnRMousePressed": null,
  "OnMouseClick": null,
  "OnLMouseClick": null,
  "OnRMouseClick": null,
  "OnMouseMove": null,
  "OnGlobalMouseDown": null,
  "OnGlobalMouseUp": null,
  "OnGlobalMousePressed": null,
  "OnGlobalMouseClick": null,
  "OnGlobalMouseMove": null,
  "OnInput": null,
  "OnGlobalInput": null,
  "OnActiveChanged": null,
  "OnFocusChanged": null,
  "OnHoverChanged": null,
  "OnDragChanged": null,
  "OnResizeGrid": null,
  "OnDrawItem": null,
  "Children": [
    {
      "$type": "Panel",
      "BackgroundImage": null,
      "BackgroundImageLayout": "None",
      "CropContent": false,
      "IsVerticalScroll": false,
      "IsHorizontalScroll": false,
      "Expanded": false,
      "Selected": true,
      "Active": true,
      "Name": "Cursor",
      "Position": "0, 0",
      "Size": "0, 0",
      "Anchor": "None",
      "Dock": "None",
      "IsDraggable": false,
      "IsNotHittable": false,
      "CheckTransparentOnHit": false,
      "GlobalScope": "",
      "ClassFields": "Sprite::Sprite CursorDefault;\r\nSprite::Sprite CursorHand;\r\nSprite::Sprite CursorWait;\r\nSprite::Sprite CursorAttack;\r\nSprite::Sprite CursorUseItem;\r\nSprite::Sprite CursorUseSkill;\r\nSprite::Sprite[] CursorMoveScreen = {};\r\n\r\nint CurCrittersCountour;",
      "OnInit": "            CursorDefault = Sprite::Sprite( \"art/intrface/cursor_default.png\" );\r\n            CursorHand = Sprite::Sprite( \"art/intrface/cursor_hand.png\" );\r\n            CursorWait = Sprite::Sprite( \"art/intrface/cursor_wait.png\" );\r\n            CursorAttack = Sprite::Sprite( \"art/intrface/cursor_attack.png\" );\r\n            CursorUseItem = Sprite::Sprite( \"art/intrface/cursor_use_item.png\" );\r\n            CursorUseSkill = Sprite::Sprite( \"art/intrface/cursor_use_skill.png\" );\r\n            CursorMoveScreen = array< Sprite::Sprite >( 8 );\r\n            for(int i = 0; i < 8; i++)\r\n                CursorMoveScreen[ i ] = Sprite::Sprite();\r\n            CursorMoveScreen[ 0 ].Load( \"art/intrface/cursor_move_screen_u.png\" );\r\n            CursorMoveScreen[ 1 ].Load( \"art/intrface/cursor_move_screen_ur.png\" );\r\n            CursorMoveScreen[ 2 ].Load( \"art/intrface/cursor_move_screen_r.png\" );\r\n            CursorMoveScreen[ 3 ].Load( \"art/intrface/cursor_move_screen_dr.png\" );\r\n            CursorMoveScreen[ 4 ].Load( \"art/intrface/cursor_move_screen_d.png\" );\r\n            CursorMoveScreen[ 5 ].Load( \"art/intrface/cursor_move_screen_dl.png\" );\r\n            CursorMoveScreen[ 6 ].Load( \"art/intrface/cursor_move_screen_l.png\" );\r\n            CursorMoveScreen[ 7 ].Load( \"art/intrface/cursor_move_screen_ul.png\" );\r\n",
      "OnShow": null,
      "OnHide": null,
      "OnAppear": null,
      "OnDisappear": null,
      "OnDraw": "if( __HideCursor )\r\n    return;\r\n\r\n// Wait\r\nint cursor = __Cursor;\r\nif( __WaitPing )\r\n{\r\n    CursorWait.Draw( __MouseX, __MouseY, 0, 0, 0, 0 );\r\n    return;\r\n}\r\n// Move cursor\r\n__ShowMoveCursor = ( cursor == CursorType::Move );\r\n// Game scroll\r\nbool hasMouseScroll = true;\r\nif( __ScrollMouseLeft && __ScrollMouseUp )\r\n    CursorMoveScreen[ 7 ].Draw( __MouseX, __MouseY, 0, 0, -1, -1 );\r\nelse if( __ScrollMouseRight && __ScrollMouseUp )\r\n    CursorMoveScreen[ 1 ].Draw( __MouseX, __MouseY, 0, 0, 1, -1 );\r\nelse if( __ScrollMouseLeft && __ScrollMouseDown )\r\n    CursorMoveScreen[ 5 ].Draw( __MouseX, __MouseY, 0, 0, -1, 1 );\r\nelse if( __ScrollMouseRight && __ScrollMouseDown )\r\n    CursorMoveScreen[ 3 ].Draw( __MouseX, __MouseY, 0, 0, 1, 1 );\r\nelse if( __ScrollMouseLeft )\r\n    CursorMoveScreen[ 6 ].Draw( __MouseX, __MouseY, 0, 0, -1, 0 );\r\nelse if( __ScrollMouseRight )\r\n    CursorMoveScreen[ 2 ].Draw( __MouseX, __MouseY, 0, 0, 1, 0 );\r\nelse if( __ScrollMouseUp )\r\n    CursorMoveScreen[ 0 ].Draw( __MouseX, __MouseY, 0, 0, 0, -1 );\r\nelse if( __ScrollMouseDown )\r\n    CursorMoveScreen[ 4 ].Draw( __MouseX, __MouseY, 0, 0, 0, 1 );\r\nelse\r\n    hasMouseScroll = false;\r\nif( hasMouseScroll )\r\n    return;\r\n// Attack contours\r\nint contour = ( cursor == CursorType::UseWeapon ? 3 : 0 );\r\nif( contour != CurCrittersCountour )\r\n{\r\n    CurCrittersCountour = contour;\r\n    CustomCall( \"SetCrittersContour \" + CurCrittersCountour );\r\n}\r\n\r\n// Other cursors\r\nif( cursor == CursorType::UseWeapon )\r\n{\r\n    CursorAttack.Draw( __MouseX, __MouseY, 0, 0, 0, 0 );\r\n\r\n    Critter@ chosen = GetChosen();\r\n    if( chosen is null )\r\n        return;\r\n\r\n    Critter@ cr = GetMonitorCritter( __MouseX, __MouseY );\r\n    if( cr is null || cr is chosen )\r\n        return;\r\n\r\n    uint attackDist = Parameters::GetActiveItemAttackDistantion( chosen );\r\n    if( attackDist == 0 )\r\n        return;\r\n\r\n    bool trace = false;\r\n    Critter@[] critters = {};\r\n    critters = GetCrittersPath( chosen.HexX, chosen.HexY, cr.HexX, cr.HexY, 0.0f, attackDist, CritterFindType::Any );\r\n    for( uint i = 0; i < critters.length(); i++ )\r\n    {\r\n        if( critters[ i ].Id == cr.Id )\r\n        {\r\n            trace = true;\r\n            break;\r\n        }\r\n    }\r\n    if( !trace )\r\n        return;\r\n\r\n    const Item@ item = chosen.GetItem( ItemProperty::CritSlot, SLOT_HAND1 );\r\n    int hit = ClientMain::to_hit( chosen, cr, item, item.Mode );\r\n    if( hit == 0 )\r\n        return;\r\n    \r\n    DrawText( hit + \"%\", __MouseX + 6, __MouseY + 6, 100, 100, COLOR_RED, Fonts::Default, 0 );\r\n}\r\nelse if( cursor == CursorType::UseItem )\r\n{\r\n    CursorUseItem.Draw( __MouseX, __MouseY, 0, 0, 0, 0 );\r\n}\r\nelse if( cursor == CursorType::UseSkill )\r\n{\r\n    CursorUseSkill.Draw( __MouseX, __MouseY, 0, 0, 0, 0 );\r\n}\r\nelse if( cursor == CursorType::Move )\r\n{\r\n    uint16 hx, hy;\r\n    if( !GetMonitorHex( __MouseX, __MouseY, hx, hy ) )\r\n        CursorDefault.Draw( __MouseX, __MouseY, 0, 0, -1, -1 );\r\n}\r\nelse if( cursor == CursorType::Default )\r\n{\r\n    CursorDefault.Draw( __MouseX, __MouseY, 0, 0, -1, -1 );\r\n}\r\nelse if( cursor == CursorType::Hand )\r\n{\r\n    //CustomCall( \"CurDrawHand\" );\r\n    CursorHand.Draw( __MouseX, __MouseY, 0, 0, -1, -1 );\r\n}\r\nelse\r\n{\r\n    CursorDefault.Draw( __MouseX, __MouseY, 0, 0, -1, -1 );\r\n}",
      "OnPostDraw": null,
      "OnMove": null,
      "OnMouseDown": null,
      "OnMouseUp": null,
      "OnMousePressed": null,
      "OnLMousePressed": null,
      "OnRMousePressed": null,
      "OnMouseClick": null,
      "OnLMouseClick": "Message(\"Cursor click\");",
      "OnRMouseClick": null,
      "OnMouseMove": null,
      "OnGlobalMouseDown": null,
      "OnGlobalMouseUp": null,
      "OnGlobalMousePressed": null,
      "OnGlobalMouseClick": null,
      "OnGlobalMouseMove": null,
      "OnInput": null,
      "OnGlobalInput": null,
      "OnActiveChanged": null,
      "OnFocusChanged": null,
      "OnHoverChanged": null,
      "OnDragChanged": null,
      "OnResizeGrid": null,
      "OnDrawItem": null,
      "Children": []
    },
    {
      "$type": "Panel",
      "BackgroundImage": null,
      "BackgroundImageLayout": "None",
      "CropContent": false,
      "IsVerticalScroll": false,
      "IsHorizontalScroll": false,
      "Expanded": true,
      "Selected": false,
      "Active": true,
      "Name": "LMenu",
      "Position": "0, 0",
      "Size": "0, 0",
      "Anchor": "None",
      "Dock": "None",
      "IsDraggable": false,
      "IsNotHittable": false,
      "CheckTransparentOnHit": false,
      "GlobalScope": null,
      "ClassFields": null,
      "OnInit": null,
      "OnShow": null,
      "OnHide": null,
      "OnAppear": null,
      "OnDisappear": null,
      "OnDraw": null,
      "OnPostDraw": null,
      "OnMove": null,
      "OnMouseDown": null,
      "OnMouseUp": null,
      "OnMousePressed": null,
      "OnLMousePressed": null,
      "OnRMousePressed": null,
      "OnMouseClick": null,
      "OnLMouseClick": null,
      "OnRMouseClick": null,
      "OnMouseMove": null,
      "OnGlobalMouseDown": null,
      "OnGlobalMouseUp": null,
      "OnGlobalMousePressed": null,
      "OnGlobalMouseClick": null,
      "OnGlobalMouseMove": null,
      "OnInput": null,
      "OnGlobalInput": null,
      "OnActiveChanged": null,
      "OnFocusChanged": null,
      "OnHoverChanged": null,
      "OnDragChanged": null,
      "OnResizeGrid": null,
      "OnDrawItem": null,
      "Children": [
        {
          "$type": "Grid",
          "CellPrototype": "\"MenuSlot\"",
          "GridSize": null,
          "Columns": 0,
          "Padding": "0, 0",
          "BackgroundImage": null,
          "BackgroundImageLayout": "None",
          "CropContent": false,
          "IsVerticalScroll": false,
          "IsHorizontalScroll": false,
          "Expanded": true,
          "Selected": false,
          "Active": true,
          "Name": "MenuSlots",
          "Position": "0, 0",
          "Size": "40, 300",
          "Anchor": "None",
          "Dock": "None",
          "IsDraggable": false,
          "IsNotHittable": false,
          "CheckTransparentOnHit": false,
          "GlobalScope": null,
          "ClassFields": null,
          "OnInit": null,
          "OnShow": null,
          "OnHide": null,
          "OnAppear": null,
          "OnDisappear": null,
          "OnDraw": null,
          "OnPostDraw": null,
          "OnMove": null,
          "OnMouseDown": null,
          "OnMouseUp": null,
          "OnMousePressed": null,
          "OnLMousePressed": null,
          "OnRMousePressed": null,
          "OnMouseClick": null,
          "OnLMouseClick": null,
          "OnRMouseClick": null,
          "OnMouseMove": null,
          "OnGlobalMouseDown": null,
          "OnGlobalMouseUp": null,
          "OnGlobalMousePressed": null,
          "OnGlobalMouseClick": null,
          "OnGlobalMouseMove": null,
          "OnInput": null,
          "OnGlobalInput": null,
          "OnActiveChanged": null,
          "OnFocusChanged": null,
          "OnHoverChanged": null,
          "OnDragChanged": null,
          "OnResizeGrid": null,
          "OnDrawItem": null,
          "Children": [
            {
              "$type": "Panel",
              "BackgroundImage": "art/intrface/lmenu_sortdown_dn.png",
              "BackgroundImageLayout": "None",
              "CropContent": false,
              "IsVerticalScroll": false,
              "IsHorizontalScroll": false,
              "Expanded": false,
              "Selected": false,
              "Active": true,
              "Name": "MenuSlot",
              "Position": "0, 1",
              "Size": "40, 40",
              "Anchor": "None",
              "Dock": "None",
              "IsDraggable": false,
              "IsNotHittable": false,
              "CheckTransparentOnHit": false,
              "GlobalScope": null,
              "ClassFields": null,
              "OnInit": null,
              "OnShow": null,
              "OnHide": null,
              "OnAppear": null,
              "OnDisappear": null,
              "OnDraw": null,
              "OnPostDraw": null,
              "OnMove": null,
              "OnMouseDown": null,
              "OnMouseUp": null,
              "OnMousePressed": null,
              "OnLMousePressed": null,
              "OnRMousePressed": null,
              "OnMouseClick": null,
              "OnLMouseClick": null,
              "OnRMouseClick": null,
              "OnMouseMove": null,
              "OnGlobalMouseDown": null,
              "OnGlobalMouseUp": null,
              "OnGlobalMousePressed": null,
              "OnGlobalMouseClick": null,
              "OnGlobalMouseMove": null,
              "OnInput": null,
              "OnGlobalInput": null,
              "OnActiveChanged": null,
              "OnFocusChanged": null,
              "OnHoverChanged": null,
              "OnDragChanged": null,
              "OnResizeGrid": null,
              "OnDrawItem": null,
              "Children": []
            }
          ]
        }
      ]
    }
  ]
}