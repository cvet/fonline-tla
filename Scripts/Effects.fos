namespace Effects
{

///@ RemoteCall Client DoQuakeScreen(uint noise, uint timeMs)
///@ RemoteCall Client DoFadeScreen(ucolor fromColor, ucolor toColor, uint timeMs)

#if SERVER

// Default values
#define QUAKE_NOISE (8)
#define QUAKE_TIME  (800)

void FadeScreen(Critter cr, bool fadeOut, uint timeMs)
{
    if (cr.ControlledByPlayer) {
        cr.PlayerClientCall.DoFadeScreen(fadeOut ? ucolor(0, 0, 0, 0xFF) : ucolor(), fadeOut ? ucolor() : ucolor(0, 0, 0, 0xFF), timeMs);
    }
}

void FadeScreen(Critter cr, ucolor fromColor, ucolor toColor, uint timeMs)
{
    if (cr.ControlledByPlayer) {
        cr.PlayerClientCall.DoFadeScreen(fromColor, toColor, timeMs);
    }
}

void FadeScreen(Map map, bool fadeOut, uint timeMs)
{
    Critter[] critters = map.GetCritters(CritterFindType::Players);
    for (int i = 0; i < critters.length(); i++) {
        critters[i].PlayerClientCall.DoFadeScreen(fadeOut ? ucolor(0, 0, 0, 0xFF) : ucolor(), fadeOut ? ucolor() : ucolor(0, 0, 0, 0xFF), timeMs);
    }
}

void FadeScreen(Map map, ucolor fromColor, ucolor toColor, uint timeMs)
{
    Critter[] critters = map.GetCritters(CritterFindType::Players);
    for (int i = 0; i < critters.length(); i++) {
        critters[i].PlayerClientCall.DoFadeScreen(fromColor, toColor, timeMs);
    }
}

void QuakeScreen(Critter cr)
{
    if (cr.ControlledByPlayer) {
        cr.PlayerClientCall.DoQuakeScreen(QUAKE_NOISE, QUAKE_TIME);
    }
}

void QuakeScreen(Critter cr, uint noise, uint timeMs)
{
    if (cr.ControlledByPlayer) {
        cr.PlayerClientCall.DoQuakeScreen(QUAKE_NOISE, QUAKE_TIME);
    }
}

void QuakeScreen(Map map)
{
    Critter[] critters = map.GetCritters(CritterFindType::Players);
    for (int i = 0; i < critters.length(); i++) {
        critters[i].PlayerClientCall.DoQuakeScreen(QUAKE_NOISE, QUAKE_TIME);
    }
}

void QuakeScreen(Map map, uint noise, uint timeMs)
{
    Critter[] critters = map.GetCritters(CritterFindType::Players);
    for (int i = 0; i < critters.length(); i++) {
        critters[i].PlayerClientCall.DoQuakeScreen(QUAKE_NOISE, QUAKE_TIME);
    }
}

#endif

#if CLIENT

void DoFadeScreen(ucolor fromColor, ucolor toColor, uint timeMs)
{
    Game.FadeScreen(fromColor, toColor, Time::Milliseconds(timeMs));
}

void DoQuakeScreen(uint noise, uint timeMs)
{
    Game.QuakeScreen(noise, Time::Milliseconds(timeMs));
}

#endif

}
