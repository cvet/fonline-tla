{
  "$type": "Screen",
  "IsModal": false,
  "IsMultiinstance": false,
  "IsCloseOnMiss": false,
  "AvailableCursors": null,
  "IsCanMove": true,
  "IsMoveIgnoreBorders": false,
  "BackgroundImage": null,
  "BackgroundImageLayout": "None",
  "CropContent": false,
  "IsVerticalScroll": false,
  "IsHorizontalScroll": false,
  "Expanded": true,
  "Selected": false,
  "Active": true,
  "Name": "Screen",
  "Position": "82, 41",
  "Size": "800, 600",
  "Anchor": "None",
  "Dock": "Fill",
  "IsDraggable": false,
  "IsNotHittable": true,
  "CheckTransparentOnHit": false,
  "GlobalScope": "string FormatXXX( int value )\r\n{\r\n    string result = \"\";\r\n    int offs = 0;\r\n    if( value >= 0 )\r\n    {\r\n        result += Game.EncodeUtf8( '9' + 4 );\r\n    }\r\n    else\r\n    {\r\n        offs = 0x20;\r\n        result += Game.EncodeUtf8( '9' + offs + 3 );\r\n        value = -value;\r\n    }\r\n\r\n    value = CLAMP( value, 0, 999 );\r\n\r\n    result += Game.EncodeUtf8( '0' + offs + value / 100 );\r\n    result += Game.EncodeUtf8( '0' + offs + value / 10 % 10 );\r\n    result += Game.EncodeUtf8( '0' + offs + value % 10 );\r\n\r\n    return result;\r\n}\r\n\r\n\r\n void GameLMouseDown()\r\n{\r\n    Critter@ chosen = Game.GetChosen();\r\n    if( chosen is null )\r\n        return;\r\n\r\n    int cursor = Settings.Cursor;\r\n    if( cursor == CursorType::Move )\r\n    {\r\n        any[] actions = {};\r\n        ChosenActions::GetChosenActions( actions );\r\n        bool isMoveAction = ( actions.length() > 0 && actions[ 0 ] == Tla::ChosenMove );\r\n        int milliseconds  = (actions.length() > 6 ? int(actions[ 6 ]) : 0);\r\n        if( isMoveAction && (Game.FrameTime - (milliseconds == 0? ZERO_TIMESPAN : Time::Milliseconds(milliseconds))).milliseconds < Settings.DoubleClickTime )\r\n        {\r\n            actions[ 3 ] = ( Settings.AlwaysRun ? 0 : 1 );\r\n            actions[ 5 ] = 0;\r\n            ChosenActions::SetChosenActions( actions );\r\n        }\r\n        else\r\n        {\r\n            mpos hex;\r\n            if(CurMap.GetHexAtScreenPos(Settings.MousePos, hex))\r\n            {\r\n                int dist  = Game.GetDistance(chosen.Hex, hex);\r\n                bool isRun = ( Input::IsShiftDown() ? !Settings.AlwaysRun : Settings.AlwaysRun && dist >= Settings.AlwaysRunMoveDist );\r\n                ChosenActions::SetChosenActions( array< any > = { Tla::ChosenMove, hex.x, hex.y, isRun ? 1 : 0, 0, isMoveAction ? 0 : 1, Game.FrameTime } );\r\n            }\r\n        }\r\n    }\r\n    else if( cursor == CursorType::UseSkill && Settings.CursorData != 0)\r\n    {\r\n        Critter@ cr = CurMap.GetCritterAtScreenPos(ipos( Settings.MousePos.x, Settings.MousePos.y ) );\r\n        Entity@  entity = CurMap.GetEntityAtScreenPos( Settings.MousePos );\r\n        Item@    item = cast< Item >( entity );\r\n        CritterProperty skill = CritterProperty( int(Settings.CursorData) );\r\n        if( cr != null )\r\n        {\r\n            ChosenActions::SetChosenActions( array< any > = { Tla::ChosenUseSklOnCritter, int( skill ), cr.Id, 0, 0, 0, 0 } );   \r\n            GuiScreensExt::NextCursor();\r\n            Settings.CursorData = 0;\r\n        }\r\n        else\r\n        {\r\n            if( item !is null )\r\n            {\r\n                if( item.Type != ItemType::Generic && item.Type != ItemType::Grid )\r\n                {\r\n                    ChosenActions::SetChosenActions( array< any > = { Tla::ChosenUseSklOnItem, int( skill ), item.Id, 0,0, 0, 0 } );\r\n                }\r\n                else \r\n                {\r\n                    ChosenActions::SetChosenActions( array< any > = { Tla::ChosenUseSklOnScen, int( skill ), item.ProtoId.hash, item.Hex.x, item.Hex.y, 0, 0 } );\r\n                }\r\n                GuiScreensExt::NextCursor();\r\n                Settings.CursorData = 0;\r\n            }\r\n        }\r\n    }\r\n    else if( cursor == CursorType::UseItem || cursor == CursorType::UseWeapon )\r\n    {\r\n        bool        isAttack = ( cursor == CursorType::UseWeapon );\r\n        Item@ useItem = ( !isAttack && Settings.CursorData != 0 ? chosen.GetItem( ident(Settings.CursorData) ) : chosen.GetItem( ItemProperty::CritterSlot, CritterItemSlot::Main ) );\r\n        ProtoItem proto = CritterItem::GetSlotItemProto(chosen);\r\n        if( useItem !is null || (isAttack && proto != null))\r\n        {\r\n            Entity@ entity = null;\r\n            if( isAttack )\r\n                @entity = CurMap.GetEntityAtScreenPos( Settings.MousePos );\r\n            else\r\n                @entity = CurMap.GetEntityAtScreenPos( Settings.MousePos );\r\n\r\n            Critter@ cr = cast< Critter >( entity );\r\n            Item@    item = cast< Item >( entity );\r\n            Item realWeapon = chosen.GetItem( ItemProperty::CritterSlot, CritterItemSlot::Main );\r\n            int mode      = ( valid( realWeapon ) ? useItem.Mode : chosen.HandsItemMode);\r\n            if( cr !is null )\r\n            {\r\n                if( isAttack && _WeaponModeAim( mode  ) != 0 )\r\n                {\r\n                    //IsCritterCanAim( chosen.ModelName ) && \r\n                    if( !chosen.IsNoAim )\r\n                    {\r\n                        dict<string, any> dict = {};\r\n                        dict[ \"TargetCritterId\" ] = \"\" + cr.Id;\r\n                        Gui::ShowScreen( GuiScreen::Aim, dict );\r\n                    }\r\n                }\r\n                else\r\n                {\r\n                    ChosenActions::SetChosenActions( array< any > = { Tla::ChosenUseItem, valid(useItem) ? useItem.Id : ZERO_IDENT, 0, TARGET_CRITTER, cr.Id, isAttack ? mode : USE_USE, 0 } );\r\n                }\r\n            }\r\n            else if( item !is null && useItem !is null)\r\n            {\r\n                ChosenActions::SetChosenActions( array< any > = { Tla::ChosenUseItem, useItem.Id, 0, TARGET_ITEM, item.Id, USE_USE, 0 } );\r\n            }\r\n        }\r\n    }\r\n}\r\n \r\n \r\n void GameLMouseUp()\r\n {\r\n        \r\n }",
  "ClassFields": "bool isHitIfaceOnMouseDown;",
  "OnInit": null,
  "OnShow": null,
  "OnHide": null,
  "OnAppear": null,
  "OnDisappear": null,
  "OnDraw": "",
  "OnPostDraw": null,
  "OnMove": null,
  "OnMouseDown": "",
  "OnMouseUp": "",
  "OnMousePressed": null,
  "OnLMousePressed": null,
  "OnRMousePressed": null,
  "OnMouseClick": "",
  "OnLMouseClick": null,
  "OnRMouseClick": null,
  "OnMouseMove": null,
  "OnGlobalMouseDown": "if( Settings.MapZoomEnabled && Settings.MapZoomInProgress)\r\n{\r\n    if( button == MouseButton::WheelUp )\r\n        CurMap.ChangeZoom( CurMap.SpritesZoom - 0.01 );\r\n    else if( button == MouseButton::WheelDown )\r\n        CurMap.ChangeZoom( CurMap.SpritesZoom + 0.01 );\r\n    else if( button == MouseButton::Middle )\r\n        CurMap.ChangeZoom( 1.0 );\r\n}\r\n\r\nif( GetChild( 0 ).FindMouseHit() is null )\r\n{\r\n    if( button == MouseButton::Left )\r\n        GameLMouseDown();\r\n    else if( button == MouseButton::Right )\r\n        isHitIfaceOnMouseDown = ( FindMouseHit() !is null );\r\n}",
  "OnGlobalMouseUp": "if( GetChild( 0 ).FindMouseHit() is null )\r\n{\r\n    if( button == MouseButton::Left )\r\n        GameLMouseUp();\r\n    else if( button == MouseButton::Right && !isHitIfaceOnMouseDown )\r\n        GuiScreensExt::NextCursor();\r\n}",
  "OnGlobalMousePressed": null,
  "OnGlobalMouseClick": "",
  "OnGlobalMouseMove": "//Game.CustomCall( \"ProcessMouseScroll\" );\r\n if((Settings.Fullscreen && Settings.FullscreenMouseScroll) || (!Settings.Fullscreen && Settings.WindowedMouseScroll))\r\n            {\r\n                Settings.ScrollMouseRight = ( Settings.MousePos.x >= Settings.ScreenWidth - 1 );\r\n                Settings.ScrollMouseLeft  = ( Settings.MousePos.x <= 0 );\r\n                Settings.ScrollMouseDown  = ( Settings.MousePos.y >= Settings.ScreenHeight - 1 );\r\n                Settings.ScrollMouseUp    = ( Settings.MousePos.y <= 0 );\r\n            }",
  "OnInput": null,
  "OnGlobalInput": "",
  "OnActiveChanged": null,
  "OnFocusChanged": null,
  "OnHoverChanged": null,
  "OnDragChanged": null,
  "OnResizeGrid": null,
  "OnDrawItem": null,
  "Children": [
    {
      "$type": "Panel",
      "BackgroundImage": "art/intrface/iface.png",
      "BackgroundImageLayout": "None",
      "CropContent": false,
      "IsVerticalScroll": false,
      "IsHorizontalScroll": false,
      "Expanded": true,
      "Selected": false,
      "Active": true,
      "Name": "Main",
      "Position": "0, 475",
      "Size": "800, 125",
      "Anchor": "Bottom, Left, Right",
      "Dock": "None",
      "IsDraggable": false,
      "IsNotHittable": false,
      "CheckTransparentOnHit": true,
      "GlobalScope": null,
      "ClassFields": null,
      "OnInit": null,
      "OnShow": null,
      "OnHide": null,
      "OnAppear": null,
      "OnDisappear": null,
      "OnDraw": null,
      "OnPostDraw": null,
      "OnMove": null,
      "OnMouseDown": null,
      "OnMouseUp": null,
      "OnMousePressed": null,
      "OnLMousePressed": null,
      "OnRMousePressed": null,
      "OnMouseClick": null,
      "OnLMouseClick": null,
      "OnRMouseClick": null,
      "OnMouseMove": null,
      "OnGlobalMouseDown": null,
      "OnGlobalMouseUp": null,
      "OnGlobalMousePressed": null,
      "OnGlobalMouseClick": null,
      "OnGlobalMouseMove": null,
      "OnInput": null,
      "OnGlobalInput": null,
      "OnActiveChanged": null,
      "OnFocusChanged": null,
      "OnHoverChanged": null,
      "OnDragChanged": null,
      "OnResizeGrid": null,
      "OnDrawItem": null,
      "Children": [
        {
          "$type": "Panel",
          "BackgroundImage": "",
          "BackgroundImageLayout": "None",
          "CropContent": false,
          "IsVerticalScroll": false,
          "IsHorizontalScroll": false,
          "Expanded": false,
          "Selected": false,
          "Active": true,
          "Name": "Console",
          "Position": "0, -37",
          "Size": "0, 0",
          "Anchor": "None",
          "Dock": "None",
          "IsDraggable": false,
          "IsNotHittable": false,
          "CheckTransparentOnHit": false,
          "GlobalScope": null,
          "ClassFields": null,
          "OnInit": null,
          "OnShow": null,
          "OnHide": null,
          "OnAppear": null,
          "OnDisappear": null,
          "OnDraw": null,
          "OnPostDraw": null,
          "OnMove": null,
          "OnMouseDown": null,
          "OnMouseUp": null,
          "OnMousePressed": null,
          "OnLMousePressed": null,
          "OnRMousePressed": null,
          "OnMouseClick": null,
          "OnLMouseClick": null,
          "OnRMouseClick": null,
          "OnMouseMove": null,
          "OnGlobalMouseDown": null,
          "OnGlobalMouseUp": null,
          "OnGlobalMousePressed": null,
          "OnGlobalMouseClick": null,
          "OnGlobalMouseMove": null,
          "OnInput": null,
          "OnGlobalInput": null,
          "OnActiveChanged": null,
          "OnFocusChanged": null,
          "OnHoverChanged": null,
          "OnDragChanged": null,
          "OnResizeGrid": null,
          "OnDrawItem": null,
          "Children": [
            {
              "$type": "Panel",
              "BackgroundImage": "art/intrface/panel.png",
              "BackgroundImageLayout": "None",
              "CropContent": false,
              "IsVerticalScroll": false,
              "IsHorizontalScroll": false,
              "Expanded": false,
              "Selected": false,
              "Active": true,
              "Name": "ConsoleImage",
              "Position": "0, 0",
              "Size": "800, 35",
              "Anchor": "None",
              "Dock": "None",
              "IsDraggable": false,
              "IsNotHittable": false,
              "CheckTransparentOnHit": false,
              "GlobalScope": null,
              "ClassFields": null,
              "OnInit": null,
              "OnShow": null,
              "OnHide": null,
              "OnAppear": null,
              "OnDisappear": null,
              "OnDraw": null,
              "OnPostDraw": null,
              "OnMove": null,
              "OnMouseDown": null,
              "OnMouseUp": null,
              "OnMousePressed": null,
              "OnLMousePressed": null,
              "OnRMousePressed": null,
              "OnMouseClick": null,
              "OnLMouseClick": null,
              "OnRMouseClick": null,
              "OnMouseMove": null,
              "OnGlobalMouseDown": null,
              "OnGlobalMouseUp": null,
              "OnGlobalMousePressed": null,
              "OnGlobalMouseClick": null,
              "OnGlobalMouseMove": null,
              "OnInput": null,
              "OnGlobalInput": null,
              "OnActiveChanged": null,
              "OnFocusChanged": null,
              "OnHoverChanged": null,
              "OnDragChanged": null,
              "OnResizeGrid": null,
              "OnDrawItem": null,
              "Children": []
            },
            {
              "$type": "Console",
              "DisableDeactivation": false,
              "HistoryStorageName": "",
              "HistoryMaxLength": null,
              "InputLength": null,
              "Password": false,
              "Text": null,
              "DynamicText": null,
              "Font": null,
              "VerticalAlignment": "Near",
              "HorisontalAlignment": "Near",
              "Align": false,
              "NoColorize": false,
              "Bordered": false,
              "DrawFromBottom": false,
              "NormalColor": null,
              "FocusedColor": null,
              "Expanded": false,
              "Selected": false,
              "Active": false,
              "Name": "ConsoleText",
              "Position": "13, 14",
              "Size": "0, 0",
              "Anchor": "None",
              "Dock": "None",
              "IsDraggable": false,
              "IsNotHittable": true,
              "CheckTransparentOnHit": false,
              "GlobalScope": null,
              "ClassFields": null,
              "OnInit": null,
              "OnShow": null,
              "OnHide": null,
              "OnAppear": null,
              "OnDisappear": null,
              "OnDraw": "",
              "OnPostDraw": null,
              "OnMove": null,
              "OnMouseDown": null,
              "OnMouseUp": null,
              "OnMousePressed": null,
              "OnLMousePressed": null,
              "OnRMousePressed": null,
              "OnMouseClick": null,
              "OnLMouseClick": null,
              "OnRMouseClick": null,
              "OnMouseMove": null,
              "OnGlobalMouseDown": null,
              "OnGlobalMouseUp": null,
              "OnGlobalMousePressed": null,
              "OnGlobalMouseClick": null,
              "OnGlobalMouseMove": null,
              "OnInput": null,
              "OnGlobalInput": null,
              "OnActiveChanged": "Parent.Find( \"ConsoleImage\" ).SetActive( ActiveSelf ); ",
              "OnFocusChanged": null,
              "OnHoverChanged": null,
              "OnDragChanged": null,
              "OnResizeGrid": null,
              "OnDrawItem": null,
              "Children": []
            }
          ]
        },
        {
          "$type": "Panel",
          "BackgroundImage": "art/intrface/iface_add_mess.png",
          "BackgroundImageLayout": "None",
          "CropContent": false,
          "IsVerticalScroll": false,
          "IsHorizontalScroll": false,
          "Expanded": false,
          "Selected": false,
          "Active": false,
          "Name": "MessageBoxExtended",
          "Position": "0, -55",
          "Size": "372, 112",
          "Anchor": "None",
          "Dock": "None",
          "IsDraggable": false,
          "IsNotHittable": false,
          "CheckTransparentOnHit": false,
          "GlobalScope": null,
          "ClassFields": null,
          "OnInit": null,
          "OnShow": null,
          "OnHide": null,
          "OnAppear": null,
          "OnDisappear": null,
          "OnDraw": null,
          "OnPostDraw": null,
          "OnMove": null,
          "OnMouseDown": null,
          "OnMouseUp": null,
          "OnMousePressed": null,
          "OnLMousePressed": null,
          "OnRMousePressed": null,
          "OnMouseClick": null,
          "OnLMouseClick": null,
          "OnRMouseClick": null,
          "OnMouseMove": null,
          "OnGlobalMouseDown": null,
          "OnGlobalMouseUp": null,
          "OnGlobalMousePressed": null,
          "OnGlobalMouseClick": null,
          "OnGlobalMouseMove": null,
          "OnInput": null,
          "OnGlobalInput": null,
          "OnActiveChanged": null,
          "OnFocusChanged": null,
          "OnHoverChanged": null,
          "OnDragChanged": null,
          "OnResizeGrid": null,
          "OnDrawItem": null,
          "Children": []
        },
        {
          "$type": "MessageBox",
          "InvertMessages": null,
          "DisplayedMessages": "array<MessageBoxType> = { MessageBoxType::Default, MessageBoxType::Combat, MessageBoxType::Look }",
          "Text": null,
          "DynamicText": null,
          "Font": null,
          "VerticalAlignment": "Near",
          "HorisontalAlignment": "Near",
          "Align": false,
          "NoColorize": false,
          "Bordered": false,
          "DrawFromBottom": false,
          "NormalColor": null,
          "FocusedColor": null,
          "Expanded": false,
          "Selected": false,
          "Active": true,
          "Name": "MessageBoxText",
          "Position": "34, 28",
          "Size": "306, 76",
          "Anchor": "Top",
          "Dock": "None",
          "IsDraggable": false,
          "IsNotHittable": false,
          "CheckTransparentOnHit": false,
          "GlobalScope": null,
          "ClassFields": "void FiltersChanged()\r\n{\r\n    bool filter1Checked = cast< Gui::CheckBox >( Parent.Find( \"Filter1\" ) ).IsChecked;\r\n    bool filter2Checked = cast< Gui::CheckBox >( Parent.Find( \"Filter2\" ) ).IsChecked;\r\n    \r\n    ChangeDisplayedMessage(MessageBoxType::Talk, filter1Checked);\r\n    ChangeDisplayedMessage(MessageBoxType::Combat, filter2Checked);\r\n}\r\n",
          "OnInit": null,
          "OnShow": null,
          "OnHide": null,
          "OnAppear": null,
          "OnDisappear": null,
          "OnDraw": null,
          "OnPostDraw": null,
          "OnMove": null,
          "OnMouseDown": null,
          "OnMouseUp": null,
          "OnMousePressed": null,
          "OnLMousePressed": null,
          "OnRMousePressed": null,
          "OnMouseClick": null,
          "OnLMouseClick": null,
          "OnRMouseClick": null,
          "OnMouseMove": null,
          "OnGlobalMouseDown": null,
          "OnGlobalMouseUp": null,
          "OnGlobalMousePressed": null,
          "OnGlobalMouseClick": null,
          "OnGlobalMouseMove": null,
          "OnInput": null,
          "OnGlobalInput": null,
          "OnActiveChanged": null,
          "OnFocusChanged": null,
          "OnHoverChanged": null,
          "OnDragChanged": null,
          "OnResizeGrid": null,
          "OnDrawItem": null,
          "Children": []
        },
        {
          "$type": "CheckBox",
          "IsChecked": null,
          "OnCheckedChanged": "Gui::Object@ messageBoxText = Parent.Find( \"MessageBoxText\" );\r\nGui::Object@ messageBoxExtended = Parent.Find( \"MessageBoxExtended\" );\r\nGui::Object@ console = Parent.Find( \"Console\" );\r\n\r\nmessageBoxText.SetSize( messageBoxText.Size.width, IsChecked ? 131 : 76 );\r\nmessageBoxText.SetPosition( messageBoxText.Pos.x, IsChecked ? -27 : 28 );\r\nmessageBoxExtended.SetActive( IsChecked );\r\nconsole.SetPosition( 0, IsChecked ? -92 : -37 );",
          "IsDisabled": false,
          "PressedImage": "art/intrface/iface_small_btn.png",
          "PressedImageLayout": "None",
          "HoverImage": null,
          "HoverImageLayout": "None",
          "DisabledImage": null,
          "DisabledImageLayout": "None",
          "BackgroundImage": null,
          "BackgroundImageLayout": "None",
          "CropContent": false,
          "IsVerticalScroll": false,
          "IsHorizontalScroll": false,
          "Expanded": false,
          "Selected": false,
          "Active": true,
          "Name": "ExtendMessageBox",
          "Position": "355, 60",
          "Size": "11, 6",
          "Anchor": "None",
          "Dock": "None",
          "IsDraggable": false,
          "IsNotHittable": false,
          "CheckTransparentOnHit": false,
          "GlobalScope": null,
          "ClassFields": null,
          "OnInit": null,
          "OnShow": null,
          "OnHide": null,
          "OnAppear": null,
          "OnDisappear": null,
          "OnDraw": null,
          "OnPostDraw": null,
          "OnMove": null,
          "OnMouseDown": null,
          "OnMouseUp": null,
          "OnMousePressed": null,
          "OnLMousePressed": null,
          "OnRMousePressed": null,
          "OnMouseClick": null,
          "OnLMouseClick": null,
          "OnRMouseClick": null,
          "OnMouseMove": null,
          "OnGlobalMouseDown": null,
          "OnGlobalMouseUp": null,
          "OnGlobalMousePressed": null,
          "OnGlobalMouseClick": null,
          "OnGlobalMouseMove": null,
          "OnInput": null,
          "OnGlobalInput": null,
          "OnActiveChanged": null,
          "OnFocusChanged": null,
          "OnHoverChanged": null,
          "OnDragChanged": null,
          "OnResizeGrid": null,
          "OnDrawItem": null,
          "Children": []
        },
        {
          "$type": "CheckBox",
          "IsChecked": null,
          "OnCheckedChanged": "cast< MessageBoxText >( Parent.Find( \"MessageBoxText\" ) ).FiltersChanged();",
          "IsDisabled": false,
          "PressedImage": "art/intrface/iface_small_btn.png",
          "PressedImageLayout": "None",
          "HoverImage": null,
          "HoverImageLayout": "None",
          "DisabledImage": null,
          "DisabledImageLayout": "None",
          "BackgroundImage": null,
          "BackgroundImageLayout": "None",
          "CropContent": false,
          "IsVerticalScroll": false,
          "IsHorizontalScroll": false,
          "Expanded": false,
          "Selected": false,
          "Active": true,
          "Name": "Filter1",
          "Position": "355, 68",
          "Size": "11, 6",
          "Anchor": "None",
          "Dock": "None",
          "IsDraggable": false,
          "IsNotHittable": false,
          "CheckTransparentOnHit": false,
          "GlobalScope": null,
          "ClassFields": null,
          "OnInit": null,
          "OnShow": null,
          "OnHide": null,
          "OnAppear": null,
          "OnDisappear": null,
          "OnDraw": null,
          "OnPostDraw": null,
          "OnMove": null,
          "OnMouseDown": null,
          "OnMouseUp": null,
          "OnMousePressed": null,
          "OnLMousePressed": null,
          "OnRMousePressed": null,
          "OnMouseClick": null,
          "OnLMouseClick": null,
          "OnRMouseClick": null,
          "OnMouseMove": null,
          "OnGlobalMouseDown": null,
          "OnGlobalMouseUp": null,
          "OnGlobalMousePressed": null,
          "OnGlobalMouseClick": null,
          "OnGlobalMouseMove": null,
          "OnInput": null,
          "OnGlobalInput": null,
          "OnActiveChanged": null,
          "OnFocusChanged": null,
          "OnHoverChanged": null,
          "OnDragChanged": null,
          "OnResizeGrid": null,
          "OnDrawItem": null,
          "Children": []
        },
        {
          "$type": "CheckBox",
          "IsChecked": null,
          "OnCheckedChanged": "cast< MessageBoxText >( Parent.Find( \"MessageBoxText\" ) ).FiltersChanged();",
          "IsDisabled": false,
          "PressedImage": "art/intrface/iface_small_btn.png",
          "PressedImageLayout": "None",
          "HoverImage": null,
          "HoverImageLayout": "None",
          "DisabledImage": null,
          "DisabledImageLayout": "None",
          "BackgroundImage": null,
          "BackgroundImageLayout": "None",
          "CropContent": false,
          "IsVerticalScroll": false,
          "IsHorizontalScroll": false,
          "Expanded": false,
          "Selected": false,
          "Active": true,
          "Name": "Filter2",
          "Position": "355, 75",
          "Size": "11, 6",
          "Anchor": "None",
          "Dock": "None",
          "IsDraggable": false,
          "IsNotHittable": false,
          "CheckTransparentOnHit": false,
          "GlobalScope": null,
          "ClassFields": null,
          "OnInit": null,
          "OnShow": null,
          "OnHide": null,
          "OnAppear": null,
          "OnDisappear": null,
          "OnDraw": null,
          "OnPostDraw": null,
          "OnMove": null,
          "OnMouseDown": null,
          "OnMouseUp": null,
          "OnMousePressed": null,
          "OnLMousePressed": null,
          "OnRMousePressed": null,
          "OnMouseClick": null,
          "OnLMouseClick": null,
          "OnRMouseClick": null,
          "OnMouseMove": null,
          "OnGlobalMouseDown": null,
          "OnGlobalMouseUp": null,
          "OnGlobalMousePressed": null,
          "OnGlobalMouseClick": null,
          "OnGlobalMouseMove": null,
          "OnInput": null,
          "OnGlobalInput": null,
          "OnActiveChanged": null,
          "OnFocusChanged": null,
          "OnHoverChanged": null,
          "OnDragChanged": null,
          "OnResizeGrid": null,
          "OnDrawItem": null,
          "Children": []
        },
        {
          "$type": "Button",
          "IsDisabled": false,
          "PressedImage": "art/intrface/game_menu_button_dn.png",
          "PressedImageLayout": "None",
          "HoverImage": null,
          "HoverImageLayout": "None",
          "DisabledImage": null,
          "DisabledImageLayout": "None",
          "BackgroundImage": null,
          "BackgroundImageLayout": "None",
          "CropContent": false,
          "IsVerticalScroll": false,
          "IsHorizontalScroll": false,
          "Expanded": false,
          "Selected": false,
          "Active": true,
          "Name": "GameMenu",
          "Position": "370, 87",
          "Size": "34, 34",
          "Anchor": "None",
          "Dock": "None",
          "IsDraggable": false,
          "IsNotHittable": false,
          "CheckTransparentOnHit": false,
          "GlobalScope": null,
          "ClassFields": null,
          "OnInit": null,
          "OnShow": null,
          "OnHide": null,
          "OnAppear": null,
          "OnDisappear": null,
          "OnDraw": null,
          "OnPostDraw": null,
          "OnMove": null,
          "OnMouseDown": null,
          "OnMouseUp": null,
          "OnMousePressed": null,
          "OnLMousePressed": null,
          "OnRMousePressed": null,
          "OnMouseClick": null,
          "OnLMouseClick": "Gui::ShowScreen( GuiScreen::Menu );",
          "OnRMouseClick": null,
          "OnMouseMove": null,
          "OnGlobalMouseDown": null,
          "OnGlobalMouseUp": null,
          "OnGlobalMousePressed": null,
          "OnGlobalMouseClick": null,
          "OnGlobalMouseMove": null,
          "OnInput": null,
          "OnGlobalInput": null,
          "OnActiveChanged": null,
          "OnFocusChanged": null,
          "OnHoverChanged": null,
          "OnDragChanged": null,
          "OnResizeGrid": null,
          "OnDrawItem": null,
          "Children": []
        },
        {
          "$type": "Button",
          "IsDisabled": false,
          "PressedImage": "art/intrface/inv_button_dn.png",
          "PressedImageLayout": "None",
          "HoverImage": null,
          "HoverImageLayout": "None",
          "DisabledImage": null,
          "DisabledImageLayout": "None",
          "BackgroundImage": null,
          "BackgroundImageLayout": "None",
          "CropContent": false,
          "IsVerticalScroll": false,
          "IsHorizontalScroll": false,
          "Expanded": false,
          "Selected": false,
          "Active": true,
          "Name": "Inventory",
          "Position": "371, 65",
          "Size": "32, 21",
          "Anchor": "None",
          "Dock": "None",
          "IsDraggable": false,
          "IsNotHittable": false,
          "CheckTransparentOnHit": false,
          "GlobalScope": null,
          "ClassFields": null,
          "OnInit": null,
          "OnShow": null,
          "OnHide": null,
          "OnAppear": null,
          "OnDisappear": null,
          "OnDraw": null,
          "OnPostDraw": null,
          "OnMove": null,
          "OnMouseDown": null,
          "OnMouseUp": null,
          "OnMousePressed": null,
          "OnLMousePressed": null,
          "OnRMousePressed": null,
          "OnMouseClick": null,
          "OnLMouseClick": "Gui::ShowScreen( GuiScreen::Inventory );",
          "OnRMouseClick": null,
          "OnMouseMove": null,
          "OnGlobalMouseDown": null,
          "OnGlobalMouseUp": null,
          "OnGlobalMousePressed": null,
          "OnGlobalMouseClick": null,
          "OnGlobalMouseMove": null,
          "OnInput": null,
          "OnGlobalInput": null,
          "OnActiveChanged": null,
          "OnFocusChanged": null,
          "OnHoverChanged": null,
          "OnDragChanged": null,
          "OnResizeGrid": null,
          "OnDrawItem": null,
          "Children": []
        },
        {
          "$type": "Button",
          "IsDisabled": false,
          "PressedImage": "art/intrface/big_red_button_dn.png",
          "PressedImageLayout": "None",
          "HoverImage": null,
          "HoverImageLayout": "None",
          "DisabledImage": null,
          "DisabledImageLayout": "None",
          "BackgroundImage": null,
          "BackgroundImageLayout": "None",
          "CropContent": false,
          "IsVerticalScroll": false,
          "IsHorizontalScroll": false,
          "Expanded": false,
          "Selected": false,
          "Active": true,
          "Name": "SwitchItems",
          "Position": "378, 32",
          "Size": "22, 21",
          "Anchor": "None",
          "Dock": "None",
          "IsDraggable": false,
          "IsNotHittable": false,
          "CheckTransparentOnHit": false,
          "GlobalScope": null,
          "ClassFields": null,
          "OnInit": null,
          "OnShow": null,
          "OnHide": null,
          "OnAppear": null,
          "OnDisappear": null,
          "OnDraw": null,
          "OnPostDraw": null,
          "OnMove": null,
          "OnMouseDown": null,
          "OnMouseUp": null,
          "OnMousePressed": null,
          "OnLMousePressed": null,
          "OnRMousePressed": null,
          "OnMouseClick": null,
          "OnLMouseClick": "//Game.CustomCall( \"ChangeSlot\" );\r\n\r\n    Critter  chosen = Game.GetChosen();\r\n    if( chosen is null )\r\n        return;\r\n    /*  \r\n    Item item1 = chosen.GetItem( ItemProperty::CritterSlot, CritterItemSlot::Main );\r\n    Item item2 = chosen.GetItem( ItemProperty::CritterSlot, CritterItemSlot::Secondary );\r\n    if( item1 != null)\r\n        ChosenActions::SetAction( array< any > = { Tla::ChosenMoveItem, item1.Id, item1.Count, CritterItemSlot::Secondary, 0, 0, 0 }, false, true );\r\n    if( item2 != null)\r\n        ChosenActions::SetAction( array< any > = { Tla::ChosenMoveItem, item2.Id, item2.Count, CritterItemSlot::Main, 0, 0, 0 }, false, true );\r\n       */\r\n       \r\n        //   Critter chosen = Game.GetChosen();\r\n    Item    item2 = chosen.GetItem( ItemProperty::CritterSlot, CritterItemSlot::Secondary );\r\n    if( item2 != null )\r\n    {\r\n        ChosenActions::SetAction( array< any > = { Tla::ChosenMoveItem, item2.Id, item2.Count, CritterItemSlot::Main, 0, 0, 0 }, false, true );\r\n        return;\r\n    }\r\n\r\n    Item item1 = chosen.GetItem( ItemProperty::CritterSlot, CritterItemSlot::Main );\r\n    if( item1 != null )\r\n        ChosenActions::SetAction( array< any > = { Tla::ChosenMoveItem, item1.Id, item1.Count, CritterItemSlot::Secondary, 0, 0, 0 }, false, true );\r\n    ",
          "OnRMouseClick": null,
          "OnMouseMove": null,
          "OnGlobalMouseDown": null,
          "OnGlobalMouseUp": null,
          "OnGlobalMousePressed": null,
          "OnGlobalMouseClick": null,
          "OnGlobalMouseMove": null,
          "OnInput": null,
          "OnGlobalInput": null,
          "OnActiveChanged": null,
          "OnFocusChanged": null,
          "OnHoverChanged": null,
          "OnDragChanged": null,
          "OnResizeGrid": null,
          "OnDrawItem": null,
          "Children": []
        },
        {
          "$type": "Button",
          "IsDisabled": false,
          "PressedImage": "art/intrface/big_red_button_dn.png",
          "PressedImageLayout": "None",
          "HoverImage": null,
          "HoverImageLayout": "None",
          "DisabledImage": null,
          "DisabledImageLayout": "None",
          "BackgroundImage": null,
          "BackgroundImageLayout": "None",
          "CropContent": false,
          "IsVerticalScroll": false,
          "IsHorizontalScroll": false,
          "Expanded": false,
          "Selected": false,
          "Active": true,
          "Name": "Skills",
          "Position": "636, 32",
          "Size": "22, 21",
          "Anchor": "None",
          "Dock": "None",
          "IsDraggable": false,
          "IsNotHittable": false,
          "CheckTransparentOnHit": false,
          "GlobalScope": null,
          "ClassFields": null,
          "OnInit": null,
          "OnShow": null,
          "OnHide": null,
          "OnAppear": null,
          "OnDisappear": null,
          "OnDraw": null,
          "OnPostDraw": null,
          "OnMove": null,
          "OnMouseDown": null,
          "OnMouseUp": null,
          "OnMousePressed": null,
          "OnLMousePressed": null,
          "OnRMousePressed": null,
          "OnMouseClick": null,
          "OnLMouseClick": "Gui::ShowScreen( GuiScreen::SkillBox );",
          "OnRMouseClick": null,
          "OnMouseMove": null,
          "OnGlobalMouseDown": null,
          "OnGlobalMouseUp": null,
          "OnGlobalMousePressed": null,
          "OnGlobalMouseClick": null,
          "OnGlobalMouseMove": null,
          "OnInput": null,
          "OnGlobalInput": null,
          "OnActiveChanged": null,
          "OnFocusChanged": null,
          "OnHoverChanged": null,
          "OnDragChanged": null,
          "OnResizeGrid": null,
          "OnDrawItem": null,
          "Children": []
        },
        {
          "$type": "Button",
          "IsDisabled": false,
          "PressedImage": "art/intrface/map_button_dn.png",
          "PressedImageLayout": "None",
          "HoverImage": null,
          "HoverImageLayout": "None",
          "DisabledImage": null,
          "DisabledImageLayout": "None",
          "BackgroundImage": null,
          "BackgroundImageLayout": "None",
          "CropContent": false,
          "IsVerticalScroll": false,
          "IsHorizontalScroll": false,
          "Expanded": false,
          "Selected": false,
          "Active": true,
          "Name": "Map",
          "Position": "686, 46",
          "Size": "41, 19",
          "Anchor": "None",
          "Dock": "None",
          "IsDraggable": false,
          "IsNotHittable": false,
          "CheckTransparentOnHit": false,
          "GlobalScope": null,
          "ClassFields": null,
          "OnInit": null,
          "OnShow": null,
          "OnHide": null,
          "OnAppear": null,
          "OnDisappear": null,
          "OnDraw": null,
          "OnPostDraw": null,
          "OnMove": null,
          "OnMouseDown": null,
          "OnMouseUp": null,
          "OnMousePressed": null,
          "OnLMousePressed": null,
          "OnRMousePressed": null,
          "OnMouseClick": null,
          "OnLMouseClick": "//Gui::ShowScreen( GuiScreen::MiniMap );",
          "OnRMouseClick": null,
          "OnMouseMove": null,
          "OnGlobalMouseDown": null,
          "OnGlobalMouseUp": null,
          "OnGlobalMousePressed": null,
          "OnGlobalMouseClick": null,
          "OnGlobalMouseMove": null,
          "OnInput": null,
          "OnGlobalInput": null,
          "OnActiveChanged": null,
          "OnFocusChanged": null,
          "OnHoverChanged": null,
          "OnDragChanged": null,
          "OnResizeGrid": null,
          "OnDrawItem": null,
          "Children": []
        },
        {
          "$type": "Button",
          "IsDisabled": false,
          "PressedImage": "art/intrface/cha_button_dn.png",
          "PressedImageLayout": "None",
          "HoverImage": null,
          "HoverImageLayout": "None",
          "DisabledImage": null,
          "DisabledImageLayout": "None",
          "BackgroundImage": null,
          "BackgroundImageLayout": "None",
          "CropContent": false,
          "IsVerticalScroll": false,
          "IsHorizontalScroll": false,
          "Expanded": false,
          "Selected": false,
          "Active": true,
          "Name": "Character",
          "Position": "686, 65",
          "Size": "41, 19",
          "Anchor": "None",
          "Dock": "None",
          "IsDraggable": false,
          "IsNotHittable": false,
          "CheckTransparentOnHit": false,
          "GlobalScope": null,
          "ClassFields": null,
          "OnInit": null,
          "OnShow": null,
          "OnHide": null,
          "OnAppear": null,
          "OnDisappear": null,
          "OnDraw": null,
          "OnPostDraw": null,
          "OnMove": null,
          "OnMouseDown": null,
          "OnMouseUp": null,
          "OnMousePressed": null,
          "OnLMousePressed": null,
          "OnRMousePressed": null,
          "OnMouseClick": null,
          "OnLMouseClick": "Gui::ShowScreen( GuiScreen::Character );",
          "OnRMouseClick": null,
          "OnMouseMove": null,
          "OnGlobalMouseDown": null,
          "OnGlobalMouseUp": null,
          "OnGlobalMousePressed": null,
          "OnGlobalMouseClick": null,
          "OnGlobalMouseMove": null,
          "OnInput": null,
          "OnGlobalInput": null,
          "OnActiveChanged": null,
          "OnFocusChanged": null,
          "OnHoverChanged": null,
          "OnDragChanged": null,
          "OnResizeGrid": null,
          "OnDrawItem": null,
          "Children": []
        },
        {
          "$type": "Button",
          "IsDisabled": false,
          "PressedImage": "art/intrface/pip_boy_button_dn.png",
          "PressedImageLayout": "None",
          "HoverImage": null,
          "HoverImageLayout": "None",
          "DisabledImage": null,
          "DisabledImageLayout": "None",
          "BackgroundImage": null,
          "BackgroundImageLayout": "None",
          "CropContent": false,
          "IsVerticalScroll": false,
          "IsHorizontalScroll": false,
          "Expanded": false,
          "Selected": false,
          "Active": true,
          "Name": "PipBoy",
          "Position": "686, 84",
          "Size": "41, 19",
          "Anchor": "None",
          "Dock": "None",
          "IsDraggable": false,
          "IsNotHittable": false,
          "CheckTransparentOnHit": false,
          "GlobalScope": null,
          "ClassFields": null,
          "OnInit": null,
          "OnShow": null,
          "OnHide": null,
          "OnAppear": null,
          "OnDisappear": null,
          "OnDraw": null,
          "OnPostDraw": null,
          "OnMove": null,
          "OnMouseDown": null,
          "OnMouseUp": null,
          "OnMousePressed": null,
          "OnLMousePressed": null,
          "OnRMousePressed": null,
          "OnMouseClick": null,
          "OnLMouseClick": "Gui::ShowScreen( GuiScreen::PipBoy );",
          "OnRMouseClick": null,
          "OnMouseMove": null,
          "OnGlobalMouseDown": null,
          "OnGlobalMouseUp": null,
          "OnGlobalMousePressed": null,
          "OnGlobalMouseClick": null,
          "OnGlobalMouseMove": null,
          "OnInput": null,
          "OnGlobalInput": null,
          "OnActiveChanged": null,
          "OnFocusChanged": null,
          "OnHoverChanged": null,
          "OnDragChanged": null,
          "OnResizeGrid": null,
          "OnDrawItem": null,
          "Children": []
        },
        {
          "$type": "Button",
          "IsDisabled": false,
          "PressedImage": "art/intrface/iface_fix.png",
          "PressedImageLayout": "None",
          "HoverImage": null,
          "HoverImageLayout": "None",
          "DisabledImage": null,
          "DisabledImageLayout": "None",
          "BackgroundImage": null,
          "BackgroundImageLayout": "None",
          "CropContent": false,
          "IsVerticalScroll": false,
          "IsHorizontalScroll": false,
          "Expanded": false,
          "Selected": false,
          "Active": true,
          "Name": "FixBoy",
          "Position": "686, 103",
          "Size": "41, 19",
          "Anchor": "None",
          "Dock": "None",
          "IsDraggable": false,
          "IsNotHittable": false,
          "CheckTransparentOnHit": false,
          "GlobalScope": null,
          "ClassFields": null,
          "OnInit": null,
          "OnShow": null,
          "OnHide": null,
          "OnAppear": null,
          "OnDisappear": null,
          "OnDraw": null,
          "OnPostDraw": null,
          "OnMove": null,
          "OnMouseDown": null,
          "OnMouseUp": null,
          "OnMousePressed": null,
          "OnLMousePressed": null,
          "OnRMousePressed": null,
          "OnMouseClick": null,
          "OnLMouseClick": "Gui::ShowScreen( GuiScreen::FixBoy );",
          "OnRMouseClick": null,
          "OnMouseMove": null,
          "OnGlobalMouseDown": null,
          "OnGlobalMouseUp": null,
          "OnGlobalMousePressed": null,
          "OnGlobalMouseClick": null,
          "OnGlobalMouseMove": null,
          "OnInput": null,
          "OnGlobalInput": null,
          "OnActiveChanged": null,
          "OnFocusChanged": null,
          "OnHoverChanged": null,
          "OnDragChanged": null,
          "OnResizeGrid": null,
          "OnDrawItem": null,
          "Children": []
        },
        {
          "$type": "Panel",
          "BackgroundImage": "art/intrface/combat.fofrm",
          "BackgroundImageLayout": "None",
          "CropContent": false,
          "IsVerticalScroll": false,
          "IsHorizontalScroll": false,
          "Expanded": true,
          "Selected": false,
          "Active": true,
          "Name": "Combat",
          "Position": "740, 64",
          "Size": "0, 0",
          "Anchor": "None",
          "Dock": "None",
          "IsDraggable": false,
          "IsNotHittable": false,
          "CheckTransparentOnHit": false,
          "GlobalScope": null,
          "ClassFields": "bool CombatActive;",
          "OnInit": "BackgroundImage.SetFirstFrame();",
          "OnShow": null,
          "OnHide": null,
          "OnAppear": null,
          "OnDisappear": null,
          "OnDraw": "Critter@ chosen = Game.GetChosen();\r\nbool combatActive = ( chosen !is null && Time::IsTimeoutActive( chosen.TimeoutBattle ) );\r\nif( combatActive != CombatActive )\r\n{\r\n    CombatActive = combatActive;\r\n    BackgroundImage.Play( false, !combatActive );\r\n    Game.PlaySound( \"ICIBOXX1\" );\r\n}\r\n/*\r\nGetChild( 0 ).SetActive( CombatActive && Game.CustomCall( \"IsTurnBasedMyTurn\" ) == \"true\" );\r\nGetChild( 1 ).SetActive( CombatActive && IsTurnBased() );\r\n*/",
          "OnPostDraw": null,
          "OnMove": null,
          "OnMouseDown": null,
          "OnMouseUp": null,
          "OnMousePressed": null,
          "OnLMousePressed": null,
          "OnRMousePressed": null,
          "OnMouseClick": null,
          "OnLMouseClick": null,
          "OnRMouseClick": null,
          "OnMouseMove": null,
          "OnGlobalMouseDown": null,
          "OnGlobalMouseUp": null,
          "OnGlobalMousePressed": null,
          "OnGlobalMouseClick": null,
          "OnGlobalMouseMove": null,
          "OnInput": null,
          "OnGlobalInput": null,
          "OnActiveChanged": null,
          "OnFocusChanged": null,
          "OnHoverChanged": null,
          "OnDragChanged": null,
          "OnResizeGrid": null,
          "OnDrawItem": null,
          "Children": [
            {
              "$type": "Button",
              "IsDisabled": false,
              "PressedImage": "art/intrface/end_turn_button_dn.png",
              "PressedImageLayout": "None",
              "HoverImage": null,
              "HoverImageLayout": "None",
              "DisabledImage": null,
              "DisabledImageLayout": "None",
              "BackgroundImage": null,
              "BackgroundImageLayout": "None",
              "CropContent": false,
              "IsVerticalScroll": false,
              "IsHorizontalScroll": false,
              "Expanded": false,
              "Selected": false,
              "Active": false,
              "Name": "EndTurn",
              "Position": "10, 5",
              "Size": "38, 22",
              "Anchor": "None",
              "Dock": "None",
              "IsDraggable": false,
              "IsNotHittable": false,
              "CheckTransparentOnHit": false,
              "GlobalScope": null,
              "ClassFields": null,
              "OnInit": null,
              "OnShow": null,
              "OnHide": null,
              "OnAppear": null,
              "OnDisappear": null,
              "OnDraw": null,
              "OnPostDraw": null,
              "OnMove": null,
              "OnMouseDown": null,
              "OnMouseUp": null,
              "OnMousePressed": null,
              "OnLMousePressed": null,
              "OnRMousePressed": null,
              "OnMouseClick": null,
              "OnLMouseClick": "Game.CustomCall( \"EndTurn\" );",
              "OnRMouseClick": null,
              "OnMouseMove": null,
              "OnGlobalMouseDown": null,
              "OnGlobalMouseUp": null,
              "OnGlobalMousePressed": null,
              "OnGlobalMouseClick": null,
              "OnGlobalMouseMove": null,
              "OnInput": null,
              "OnGlobalInput": null,
              "OnActiveChanged": null,
              "OnFocusChanged": null,
              "OnHoverChanged": null,
              "OnDragChanged": null,
              "OnResizeGrid": null,
              "OnDrawItem": null,
              "Children": []
            },
            {
              "$type": "CheckBox",
              "IsChecked": null,
              "OnCheckedChanged": null,
              "IsDisabled": false,
              "PressedImage": "art/intrface/end_combat_button_dn.png",
              "PressedImageLayout": "None",
              "HoverImage": null,
              "HoverImageLayout": "None",
              "DisabledImage": null,
              "DisabledImageLayout": "None",
              "BackgroundImage": null,
              "BackgroundImageLayout": "None",
              "CropContent": false,
              "IsVerticalScroll": false,
              "IsHorizontalScroll": false,
              "Expanded": false,
              "Selected": false,
              "Active": false,
              "Name": "EndCombat",
              "Position": "10, 27",
              "Size": "38, 22",
              "Anchor": "None",
              "Dock": "None",
              "IsDraggable": false,
              "IsNotHittable": false,
              "CheckTransparentOnHit": false,
              "GlobalScope": null,
              "ClassFields": null,
              "OnInit": null,
              "OnShow": null,
              "OnHide": null,
              "OnAppear": null,
              "OnDisappear": null,
              "OnDraw": "Critter@ chosen = Game.GetChosen();\r\n//SetChecked( IsTurnBased() && chosen !is null && chosen.IsEndCombat );",
              "OnPostDraw": null,
              "OnMove": null,
              "OnMouseDown": null,
              "OnMouseUp": null,
              "OnMousePressed": null,
              "OnLMousePressed": null,
              "OnRMousePressed": null,
              "OnMouseClick": null,
              "OnLMouseClick": "Game.CustomCall( \"EndCombat\" );",
              "OnRMouseClick": null,
              "OnMouseMove": null,
              "OnGlobalMouseDown": null,
              "OnGlobalMouseUp": null,
              "OnGlobalMousePressed": null,
              "OnGlobalMouseClick": null,
              "OnGlobalMouseMove": null,
              "OnInput": null,
              "OnGlobalInput": null,
              "OnActiveChanged": null,
              "OnFocusChanged": null,
              "OnHoverChanged": null,
              "OnDragChanged": null,
              "OnResizeGrid": null,
              "OnDrawItem": null,
              "Children": []
            }
          ]
        },
        {
          "$type": "Grid",
          "CellPrototype": "\"Led\"",
          "GridSize": "10",
          "Columns": 10,
          "Padding": "9, 0",
          "BackgroundImage": null,
          "BackgroundImageLayout": "None",
          "CropContent": false,
          "IsVerticalScroll": false,
          "IsHorizontalScroll": false,
          "Expanded": true,
          "Selected": false,
          "Active": true,
          "Name": "ActionPoints",
          "Position": "475, 40",
          "Size": "0, 0",
          "Anchor": "None",
          "Dock": "None",
          "IsDraggable": false,
          "IsNotHittable": false,
          "CheckTransparentOnHit": false,
          "GlobalScope": null,
          "ClassFields": null,
          "OnInit": null,
          "OnShow": null,
          "OnHide": null,
          "OnAppear": null,
          "OnDisappear": null,
          "OnDraw": "Critter@ chosen = Game.GetChosen();\r\nint ap      = ( chosen !is null ? chosen.CurrentAp / AP_DIVIDER : 0 );\r\nint moveAp = 0;//( IsTurnBased() && chosen !is null ? chosen.MoveAp : 0 );\r\nfor( int i = 0; i < Cells.length(); i++ )\r\n{\r\n    int absAp = int( ABS( ap ) );\r\n    bool active = ( i < absAp + moveAp );\r\n    Cells[ i ].SetActive( active );\r\n    if( active )\r\n    {\r\n        Cells[ i ].GetChild( 0 ).SetActive( ap >= 0 && i < absAp ); // Green\r\n        Cells[ i ].GetChild( 1 ).SetActive( ap < 0 && i < absAp ); // Red\r\n        Cells[ i ].GetChild( 2 ).SetActive( i >= absAp ); // Yellow\r\n    }\r\n}",
          "OnPostDraw": null,
          "OnMove": null,
          "OnMouseDown": null,
          "OnMouseUp": null,
          "OnMousePressed": null,
          "OnLMousePressed": null,
          "OnRMousePressed": null,
          "OnMouseClick": null,
          "OnLMouseClick": null,
          "OnRMouseClick": null,
          "OnMouseMove": null,
          "OnGlobalMouseDown": null,
          "OnGlobalMouseUp": null,
          "OnGlobalMousePressed": null,
          "OnGlobalMouseClick": null,
          "OnGlobalMouseMove": null,
          "OnInput": null,
          "OnGlobalInput": null,
          "OnActiveChanged": null,
          "OnFocusChanged": null,
          "OnHoverChanged": null,
          "OnDragChanged": null,
          "OnResizeGrid": null,
          "OnDrawItem": null,
          "Children": [
            {
              "$type": "Panel",
              "BackgroundImage": "",
              "BackgroundImageLayout": "None",
              "CropContent": false,
              "IsVerticalScroll": false,
              "IsHorizontalScroll": false,
              "Expanded": true,
              "Selected": false,
              "Active": true,
              "Name": "Led",
              "Position": "0, 0",
              "Size": "0, 0",
              "Anchor": "None",
              "Dock": "None",
              "IsDraggable": false,
              "IsNotHittable": false,
              "CheckTransparentOnHit": false,
              "GlobalScope": null,
              "ClassFields": null,
              "OnInit": null,
              "OnShow": null,
              "OnHide": null,
              "OnAppear": null,
              "OnDisappear": null,
              "OnDraw": null,
              "OnPostDraw": null,
              "OnMove": null,
              "OnMouseDown": null,
              "OnMouseUp": null,
              "OnMousePressed": null,
              "OnLMousePressed": null,
              "OnRMousePressed": null,
              "OnMouseClick": null,
              "OnLMouseClick": null,
              "OnRMouseClick": null,
              "OnMouseMove": null,
              "OnGlobalMouseDown": null,
              "OnGlobalMouseUp": null,
              "OnGlobalMousePressed": null,
              "OnGlobalMouseClick": null,
              "OnGlobalMouseMove": null,
              "OnInput": null,
              "OnGlobalInput": null,
              "OnActiveChanged": null,
              "OnFocusChanged": null,
              "OnHoverChanged": null,
              "OnDragChanged": null,
              "OnResizeGrid": null,
              "OnDrawItem": null,
              "Children": [
                {
                  "$type": "Panel",
                  "BackgroundImage": "art/intrface/led_green.png",
                  "BackgroundImageLayout": "None",
                  "CropContent": false,
                  "IsVerticalScroll": false,
                  "IsHorizontalScroll": false,
                  "Expanded": false,
                  "Selected": false,
                  "Active": true,
                  "Name": "LedGreen",
                  "Position": "0, 0",
                  "Size": "5, 5",
                  "Anchor": "None",
                  "Dock": "None",
                  "IsDraggable": false,
                  "IsNotHittable": false,
                  "CheckTransparentOnHit": false,
                  "GlobalScope": null,
                  "ClassFields": null,
                  "OnInit": null,
                  "OnShow": null,
                  "OnHide": null,
                  "OnAppear": null,
                  "OnDisappear": null,
                  "OnDraw": null,
                  "OnPostDraw": null,
                  "OnMove": null,
                  "OnMouseDown": null,
                  "OnMouseUp": null,
                  "OnMousePressed": null,
                  "OnLMousePressed": null,
                  "OnRMousePressed": null,
                  "OnMouseClick": null,
                  "OnLMouseClick": null,
                  "OnRMouseClick": null,
                  "OnMouseMove": null,
                  "OnGlobalMouseDown": null,
                  "OnGlobalMouseUp": null,
                  "OnGlobalMousePressed": null,
                  "OnGlobalMouseClick": null,
                  "OnGlobalMouseMove": null,
                  "OnInput": null,
                  "OnGlobalInput": null,
                  "OnActiveChanged": null,
                  "OnFocusChanged": null,
                  "OnHoverChanged": null,
                  "OnDragChanged": null,
                  "OnResizeGrid": null,
                  "OnDrawItem": null,
                  "Children": []
                },
                {
                  "$type": "Panel",
                  "BackgroundImage": "art/intrface/led_red.png",
                  "BackgroundImageLayout": "None",
                  "CropContent": false,
                  "IsVerticalScroll": false,
                  "IsHorizontalScroll": false,
                  "Expanded": false,
                  "Selected": false,
                  "Active": true,
                  "Name": "LedRed",
                  "Position": "0, 0",
                  "Size": "5, 5",
                  "Anchor": "None",
                  "Dock": "None",
                  "IsDraggable": false,
                  "IsNotHittable": false,
                  "CheckTransparentOnHit": false,
                  "GlobalScope": null,
                  "ClassFields": null,
                  "OnInit": null,
                  "OnShow": null,
                  "OnHide": null,
                  "OnAppear": null,
                  "OnDisappear": null,
                  "OnDraw": null,
                  "OnPostDraw": null,
                  "OnMove": null,
                  "OnMouseDown": null,
                  "OnMouseUp": null,
                  "OnMousePressed": null,
                  "OnLMousePressed": null,
                  "OnRMousePressed": null,
                  "OnMouseClick": null,
                  "OnLMouseClick": null,
                  "OnRMouseClick": null,
                  "OnMouseMove": null,
                  "OnGlobalMouseDown": null,
                  "OnGlobalMouseUp": null,
                  "OnGlobalMousePressed": null,
                  "OnGlobalMouseClick": null,
                  "OnGlobalMouseMove": null,
                  "OnInput": null,
                  "OnGlobalInput": null,
                  "OnActiveChanged": null,
                  "OnFocusChanged": null,
                  "OnHoverChanged": null,
                  "OnDragChanged": null,
                  "OnResizeGrid": null,
                  "OnDrawItem": null,
                  "Children": []
                },
                {
                  "$type": "Panel",
                  "BackgroundImage": "art/intrface/led_yellow.png",
                  "BackgroundImageLayout": "None",
                  "CropContent": false,
                  "IsVerticalScroll": false,
                  "IsHorizontalScroll": false,
                  "Expanded": false,
                  "Selected": false,
                  "Active": true,
                  "Name": "LedYellow",
                  "Position": "0, 0",
                  "Size": "5, 5",
                  "Anchor": "None",
                  "Dock": "None",
                  "IsDraggable": false,
                  "IsNotHittable": false,
                  "CheckTransparentOnHit": false,
                  "GlobalScope": null,
                  "ClassFields": null,
                  "OnInit": null,
                  "OnShow": null,
                  "OnHide": null,
                  "OnAppear": null,
                  "OnDisappear": null,
                  "OnDraw": null,
                  "OnPostDraw": null,
                  "OnMove": null,
                  "OnMouseDown": null,
                  "OnMouseUp": null,
                  "OnMousePressed": null,
                  "OnLMousePressed": null,
                  "OnRMousePressed": null,
                  "OnMouseClick": null,
                  "OnLMouseClick": null,
                  "OnRMouseClick": null,
                  "OnMouseMove": null,
                  "OnGlobalMouseDown": null,
                  "OnGlobalMouseUp": null,
                  "OnGlobalMousePressed": null,
                  "OnGlobalMouseClick": null,
                  "OnGlobalMouseMove": null,
                  "OnInput": null,
                  "OnGlobalInput": null,
                  "OnActiveChanged": null,
                  "OnFocusChanged": null,
                  "OnHoverChanged": null,
                  "OnDragChanged": null,
                  "OnResizeGrid": null,
                  "OnDrawItem": null,
                  "Children": []
                }
              ]
            }
          ]
        },
        {
          "$type": "Panel",
          "BackgroundImage": "",
          "BackgroundImageLayout": "None",
          "CropContent": false,
          "IsVerticalScroll": false,
          "IsHorizontalScroll": false,
          "Expanded": true,
          "Selected": true,
          "Active": true,
          "Name": "BreakTime",
          "Position": "571, 40",
          "Size": "0, 0",
          "Anchor": "None",
          "Dock": "None",
          "IsDraggable": false,
          "IsNotHittable": false,
          "CheckTransparentOnHit": false,
          "GlobalScope": null,
          "ClassFields": null,
          "OnInit": null,
          "OnShow": null,
          "OnHide": null,
          "OnAppear": null,
          "OnDisappear": null,
          "OnDraw": "Critter@ chosen = Game.GetChosen();\r\nGetChild( 0 ).SetActive( chosen !is null && ChosenActions::IsBusy(chosen) );",
          "OnPostDraw": null,
          "OnMove": null,
          "OnMouseDown": null,
          "OnMouseUp": null,
          "OnMousePressed": null,
          "OnLMousePressed": null,
          "OnRMousePressed": null,
          "OnMouseClick": null,
          "OnLMouseClick": null,
          "OnRMouseClick": null,
          "OnMouseMove": null,
          "OnGlobalMouseDown": null,
          "OnGlobalMouseUp": null,
          "OnGlobalMousePressed": null,
          "OnGlobalMouseClick": null,
          "OnGlobalMouseMove": null,
          "OnInput": null,
          "OnGlobalInput": null,
          "OnActiveChanged": null,
          "OnFocusChanged": null,
          "OnHoverChanged": null,
          "OnDragChanged": null,
          "OnResizeGrid": null,
          "OnDrawItem": null,
          "Children": [
            {
              "$type": "Panel",
              "BackgroundImage": "art/intrface/led_red.png",
              "BackgroundImageLayout": "None",
              "CropContent": false,
              "IsVerticalScroll": false,
              "IsHorizontalScroll": false,
              "Expanded": false,
              "Selected": false,
              "Active": true,
              "Name": "BreakTimeLed",
              "Position": "0, 0",
              "Size": "5, 5",
              "Anchor": "None",
              "Dock": "None",
              "IsDraggable": false,
              "IsNotHittable": false,
              "CheckTransparentOnHit": false,
              "GlobalScope": null,
              "ClassFields": null,
              "OnInit": null,
              "OnShow": null,
              "OnHide": null,
              "OnAppear": null,
              "OnDisappear": null,
              "OnDraw": null,
              "OnPostDraw": null,
              "OnMove": null,
              "OnMouseDown": null,
              "OnMouseUp": null,
              "OnMousePressed": null,
              "OnLMousePressed": null,
              "OnRMousePressed": null,
              "OnMouseClick": null,
              "OnLMouseClick": null,
              "OnRMouseClick": null,
              "OnMouseMove": null,
              "OnGlobalMouseDown": null,
              "OnGlobalMouseUp": null,
              "OnGlobalMousePressed": null,
              "OnGlobalMouseClick": null,
              "OnGlobalMouseMove": null,
              "OnInput": null,
              "OnGlobalInput": null,
              "OnActiveChanged": null,
              "OnFocusChanged": null,
              "OnHoverChanged": null,
              "OnDragChanged": null,
              "OnResizeGrid": null,
              "OnDrawItem": null,
              "Children": []
            }
          ]
        },
        {
          "$type": "Text",
          "Text": null,
          "DynamicText": "int result = 0;\r\nCritter@ chosen = Game.GetChosen();\r\nif( chosen !is null )\r\n    result = chosen.CurrentHp;\r\nreturn FormatXXX( result );",
          "Font": "Fonts::Num",
          "VerticalAlignment": "Near",
          "HorisontalAlignment": "Near",
          "Align": false,
          "NoColorize": false,
          "Bordered": false,
          "DrawFromBottom": false,
          "NormalColor": "COLOR_NEUTRAL",
          "FocusedColor": null,
          "Expanded": false,
          "Selected": false,
          "Active": true,
          "Name": "HitPoints",
          "Position": "633, 71",
          "Size": "0, 0",
          "Anchor": "None",
          "Dock": "None",
          "IsDraggable": false,
          "IsNotHittable": false,
          "CheckTransparentOnHit": false,
          "GlobalScope": null,
          "ClassFields": null,
          "OnInit": null,
          "OnShow": null,
          "OnHide": null,
          "OnAppear": null,
          "OnDisappear": null,
          "OnDraw": null,
          "OnPostDraw": null,
          "OnMove": null,
          "OnMouseDown": null,
          "OnMouseUp": null,
          "OnMousePressed": null,
          "OnLMousePressed": null,
          "OnRMousePressed": null,
          "OnMouseClick": null,
          "OnLMouseClick": null,
          "OnRMouseClick": null,
          "OnMouseMove": null,
          "OnGlobalMouseDown": null,
          "OnGlobalMouseUp": null,
          "OnGlobalMousePressed": null,
          "OnGlobalMouseClick": null,
          "OnGlobalMouseMove": null,
          "OnInput": null,
          "OnGlobalInput": null,
          "OnActiveChanged": null,
          "OnFocusChanged": null,
          "OnHoverChanged": null,
          "OnDragChanged": null,
          "OnResizeGrid": null,
          "OnDrawItem": null,
          "Children": []
        },
        {
          "$type": "Text",
          "Text": null,
          "DynamicText": "int result = 0;\r\nCritter@ chosen = Game.GetChosen();\r\nif( chosen !is null )\r\n    result = chosen.ArmorClass;\r\nreturn FormatXXX( result );",
          "Font": "Fonts::Num",
          "VerticalAlignment": "Near",
          "HorisontalAlignment": "Near",
          "Align": false,
          "NoColorize": false,
          "Bordered": false,
          "DrawFromBottom": false,
          "NormalColor": "COLOR_NEUTRAL",
          "FocusedColor": null,
          "Expanded": false,
          "Selected": false,
          "Active": true,
          "Name": "ArmorClass",
          "Position": "633, 102",
          "Size": "0, 0",
          "Anchor": "None",
          "Dock": "None",
          "IsDraggable": false,
          "IsNotHittable": false,
          "CheckTransparentOnHit": false,
          "GlobalScope": null,
          "ClassFields": null,
          "OnInit": null,
          "OnShow": null,
          "OnHide": null,
          "OnAppear": null,
          "OnDisappear": null,
          "OnDraw": null,
          "OnPostDraw": null,
          "OnMove": null,
          "OnMouseDown": null,
          "OnMouseUp": null,
          "OnMousePressed": null,
          "OnLMousePressed": null,
          "OnRMousePressed": null,
          "OnMouseClick": null,
          "OnLMouseClick": null,
          "OnRMouseClick": null,
          "OnMouseMove": null,
          "OnGlobalMouseDown": null,
          "OnGlobalMouseUp": null,
          "OnGlobalMousePressed": null,
          "OnGlobalMouseClick": null,
          "OnGlobalMouseMove": null,
          "OnInput": null,
          "OnGlobalInput": null,
          "OnActiveChanged": null,
          "OnFocusChanged": null,
          "OnHoverChanged": null,
          "OnDragChanged": null,
          "OnResizeGrid": null,
          "OnDrawItem": null,
          "Children": []
        },
        {
          "$type": "Button",
          "IsDisabled": false,
          "PressedImage": "art/intrface/iface_item.png",
          "PressedImageLayout": "None",
          "HoverImage": null,
          "HoverImageLayout": "None",
          "DisabledImage": null,
          "DisabledImageLayout": "None",
          "BackgroundImage": null,
          "BackgroundImageLayout": "None",
          "CropContent": false,
          "IsVerticalScroll": false,
          "IsHorizontalScroll": false,
          "Expanded": false,
          "Selected": false,
          "Active": true,
          "Name": "MainItemPlate",
          "Position": "426, 52",
          "Size": "188, 67",
          "Anchor": "None",
          "Dock": "None",
          "IsDraggable": false,
          "IsNotHittable": false,
          "CheckTransparentOnHit": false,
          "GlobalScope": "",
          "ClassFields": null,
          "OnInit": null,
          "OnShow": null,
          "OnHide": null,
          "OnAppear": null,
          "OnDisappear": null,
          "OnDraw": null,
          "OnPostDraw": null,
          "OnMove": null,
          "OnMouseDown": "if( button == MouseButton::Left || button == MouseButton::Right )\r\n    GetChild( 0 ).SetPosition( 0, -2 );",
          "OnMouseUp": "GetChild( 0 ).SetPosition( 0, 0 );",
          "OnMousePressed": null,
          "OnLMousePressed": null,
          "OnRMousePressed": null,
          "OnMouseClick": "if( button == MouseButton::Left )\r\n    Parameters::UseMainItem();\r\nelse if( button == MouseButton::Right )\r\n    Parameters::SwitchMainItemMode( true );\r\nelse if( button == MouseButton::WheelUp )\r\n    Parameters::SwitchMainItemMode( false );\r\nelse if( button == MouseButton::WheelDown )\r\n    Parameters::SwitchMainItemMode( true );",
          "OnLMouseClick": "",
          "OnRMouseClick": null,
          "OnMouseMove": null,
          "OnGlobalMouseDown": null,
          "OnGlobalMouseUp": null,
          "OnGlobalMousePressed": null,
          "OnGlobalMouseClick": null,
          "OnGlobalMouseMove": null,
          "OnInput": null,
          "OnGlobalInput": null,
          "OnActiveChanged": null,
          "OnFocusChanged": null,
          "OnHoverChanged": null,
          "OnDragChanged": null,
          "OnResizeGrid": null,
          "OnDrawItem": null,
          "Children": [
            {
              "$type": "ItemView",
              "UserData": null,
              "UserDataExt": "ITEMS_CHOSEN_ALL",
              "UseSorting": false,
              "OnGetItems": "return ClientItems::RefreshItemsCollection(  UserDataExt );",
              "OnCheckItem": "return item.CritterSlot == CritterItemSlot::Main ? 0 : -1;",
              "CellPrototype": "\"MainItemSlotCell\"",
              "GridSize": "1",
              "Columns": 0,
              "Padding": "0, 0",
              "BackgroundImage": null,
              "BackgroundImageLayout": "None",
              "CropContent": false,
              "IsVerticalScroll": false,
              "IsHorizontalScroll": false,
              "Expanded": false,
              "Selected": false,
              "Active": true,
              "Name": "MainItemSlot",
              "Position": "0, 0",
              "Size": "0, 0",
              "Anchor": "None",
              "Dock": "None",
              "IsDraggable": false,
              "IsNotHittable": true,
              "CheckTransparentOnHit": false,
              "GlobalScope": null,
              "ClassFields": null,
              "OnInit": null,
              "OnShow": null,
              "OnHide": null,
              "OnAppear": null,
              "OnDisappear": null,
              "OnDraw": null,
              "OnPostDraw": null,
              "OnMove": null,
              "OnMouseDown": null,
              "OnMouseUp": null,
              "OnMousePressed": null,
              "OnLMousePressed": null,
              "OnRMousePressed": null,
              "OnMouseClick": null,
              "OnLMouseClick": null,
              "OnRMouseClick": null,
              "OnMouseMove": null,
              "OnGlobalMouseDown": null,
              "OnGlobalMouseUp": null,
              "OnGlobalMousePressed": null,
              "OnGlobalMouseClick": null,
              "OnGlobalMouseMove": null,
              "OnInput": null,
              "OnGlobalInput": null,
              "OnActiveChanged": null,
              "OnFocusChanged": null,
              "OnHoverChanged": null,
              "OnDragChanged": null,
              "OnResizeGrid": null,
              "OnDrawItem": "",
              "Children": [
                {
                  "$type": "Panel",
                  "BackgroundImage": null,
                  "BackgroundImageLayout": "Zoom",
                  "CropContent": false,
                  "IsVerticalScroll": false,
                  "IsHorizontalScroll": false,
                  "Expanded": false,
                  "Selected": false,
                  "Active": true,
                  "Name": "MainItemSlotCell",
                  "Position": "0, 0",
                  "Size": "188, 67",
                  "Anchor": "None",
                  "Dock": "None",
                  "IsDraggable": false,
                  "IsNotHittable": true,
                  "CheckTransparentOnHit": false,
                  "GlobalScope": null,
                  "ClassFields": null,
                  "OnInit": null,
                  "OnShow": null,
                  "OnHide": null,
                  "OnAppear": null,
                  "OnDisappear": null,
                  "OnDraw": "",
                  "OnPostDraw": null,
                  "OnMove": null,
                  "OnMouseDown": null,
                  "OnMouseUp": null,
                  "OnMousePressed": null,
                  "OnLMousePressed": null,
                  "OnRMousePressed": null,
                  "OnMouseClick": null,
                  "OnLMouseClick": null,
                  "OnRMouseClick": null,
                  "OnMouseMove": null,
                  "OnGlobalMouseDown": null,
                  "OnGlobalMouseUp": null,
                  "OnGlobalMousePressed": null,
                  "OnGlobalMouseClick": null,
                  "OnGlobalMouseMove": null,
                  "OnInput": null,
                  "OnGlobalInput": null,
                  "OnActiveChanged": null,
                  "OnFocusChanged": null,
                  "OnHoverChanged": null,
                  "OnDragChanged": null,
                  "OnResizeGrid": null,
                  "OnDrawItem": "hstring picInv;\r\nif( item !is null )\r\n    picInv = item.PicInv;\r\nSetBackgroundImage( picInv, SpriteLayout::Zoom );",
                  "Children": [
                    {
                      "$type": "Text",
                      "Text": null,
                      "DynamicText": null,
                      "Font": "Fonts::Special",
                      "VerticalAlignment": "Near",
                      "HorisontalAlignment": "Near",
                      "Align": false,
                      "NoColorize": false,
                      "Bordered": false,
                      "DrawFromBottom": false,
                      "NormalColor": null,
                      "FocusedColor": null,
                      "Expanded": false,
                      "Selected": false,
                      "Active": true,
                      "Name": "AmmoCount",
                      "Position": "7, 14",
                      "Size": "0, 0",
                      "Anchor": "None",
                      "Dock": "None",
                      "IsDraggable": false,
                      "IsNotHittable": true,
                      "CheckTransparentOnHit": false,
                      "GlobalScope": null,
                      "ClassFields": null,
                      "OnInit": null,
                      "OnShow": null,
                      "OnHide": null,
                      "OnAppear": null,
                      "OnDisappear": null,
                      "OnDraw": null,
                      "OnPostDraw": null,
                      "OnMove": null,
                      "OnMouseDown": null,
                      "OnMouseUp": null,
                      "OnMousePressed": null,
                      "OnLMousePressed": null,
                      "OnRMousePressed": null,
                      "OnMouseClick": null,
                      "OnLMouseClick": null,
                      "OnRMouseClick": null,
                      "OnMouseMove": null,
                      "OnGlobalMouseDown": null,
                      "OnGlobalMouseUp": null,
                      "OnGlobalMousePressed": null,
                      "OnGlobalMouseClick": null,
                      "OnGlobalMouseMove": null,
                      "OnInput": null,
                      "OnGlobalInput": null,
                      "OnActiveChanged": null,
                      "OnFocusChanged": null,
                      "OnHoverChanged": null,
                      "OnDragChanged": null,
                      "OnResizeGrid": null,
                      "OnDrawItem": "SetText( item !is null && item.Type == ItemType::Weapon ? \"\" + item.AmmoCount : \"\" );",
                      "Children": []
                    },
                    {
                      "$type": "Text",
                      "Text": null,
                      "DynamicText": null,
                      "Font": "Fonts::Special",
                      "VerticalAlignment": "Near",
                      "HorisontalAlignment": "Near",
                      "Align": false,
                      "NoColorize": false,
                      "Bordered": false,
                      "DrawFromBottom": false,
                      "NormalColor": null,
                      "FocusedColor": null,
                      "Expanded": false,
                      "Selected": false,
                      "Active": true,
                      "Name": "DeteriorationValue",
                      "Position": "7, 24",
                      "Size": "0, 0",
                      "Anchor": "None",
                      "Dock": "None",
                      "IsDraggable": false,
                      "IsNotHittable": true,
                      "CheckTransparentOnHit": false,
                      "GlobalScope": null,
                      "ClassFields": null,
                      "OnInit": null,
                      "OnShow": null,
                      "OnHide": null,
                      "OnAppear": null,
                      "OnDisappear": null,
                      "OnDraw": null,
                      "OnPostDraw": null,
                      "OnMove": null,
                      "OnMouseDown": null,
                      "OnMouseUp": null,
                      "OnMousePressed": null,
                      "OnLMousePressed": null,
                      "OnRMousePressed": null,
                      "OnMouseClick": null,
                      "OnLMouseClick": null,
                      "OnRMouseClick": null,
                      "OnMouseMove": null,
                      "OnGlobalMouseDown": null,
                      "OnGlobalMouseUp": null,
                      "OnGlobalMousePressed": null,
                      "OnGlobalMouseClick": null,
                      "OnGlobalMouseMove": null,
                      "OnInput": null,
                      "OnGlobalInput": null,
                      "OnActiveChanged": null,
                      "OnFocusChanged": null,
                      "OnHoverChanged": null,
                      "OnDragChanged": null,
                      "OnResizeGrid": null,
                      "OnDrawItem": "SetText( item !is null && item.Deteriorable ? item.Deterioration + \"%\" : \"\" );",
                      "Children": []
                    },
                    {
                      "$type": "Panel",
                      "BackgroundImage": "art/intrface/ap_pic.png",
                      "BackgroundImageLayout": "None",
                      "CropContent": false,
                      "IsVerticalScroll": false,
                      "IsHorizontalScroll": false,
                      "Expanded": false,
                      "Selected": false,
                      "Active": true,
                      "Name": "UsePic",
                      "Position": "163, 8",
                      "Size": "17, 12",
                      "Anchor": "Top, Right",
                      "Dock": "None",
                      "IsDraggable": false,
                      "IsNotHittable": true,
                      "CheckTransparentOnHit": false,
                      "GlobalScope": null,
                      "ClassFields": null,
                      "OnInit": null,
                      "OnShow": null,
                      "OnHide": null,
                      "OnAppear": null,
                      "OnDisappear": null,
                      "OnDraw": null,
                      "OnPostDraw": null,
                      "OnMove": null,
                      "OnMouseDown": null,
                      "OnMouseUp": null,
                      "OnMousePressed": null,
                      "OnLMousePressed": null,
                      "OnRMousePressed": null,
                      "OnMouseClick": null,
                      "OnLMouseClick": null,
                      "OnRMouseClick": null,
                      "OnMouseMove": null,
                      "OnGlobalMouseDown": null,
                      "OnGlobalMouseUp": null,
                      "OnGlobalMousePressed": null,
                      "OnGlobalMouseClick": null,
                      "OnGlobalMouseMove": null,
                      "OnInput": null,
                      "OnGlobalInput": null,
                      "OnActiveChanged": null,
                      "OnFocusChanged": null,
                      "OnHoverChanged": null,
                      "OnDragChanged": null,
                      "OnResizeGrid": null,
                      "OnDrawItem": "hstring usePic;\r\n\r\nItem@ useItem = item;\r\n\r\nCritter@ chosen = Game.GetChosen();\r\nif( useItem is null && chosen !is null )\r\n    @useItem = chosen.GetItem( ItemProperty::CritterSlot, CritterItemSlot::Main );\r\n    ProtoItem proto = CritterItem::GetSlotItemProto(chosen);\r\n    int mode      = (useItem == null ? chosen.HandsItemMode : useItem.Mode);\r\nif( proto !is null )\r\n{\r\n    int use = _WeaponModeUse( mode );\r\n    if( proto.Type == ItemType::Weapon )\r\n    {\r\n        if( use == USE_RELOAD )\r\n            usePic = hstring( \"art/intrface/reload.frm\" );\r\n        else if( use == USE_USE )\r\n            usePic = hstring( \"art/intrface/useon.frm\" );\r\n        else if( use < MAX_USES )\r\n            usePic = _WeaponPicUse( proto, use );\r\n    }\r\n    if( usePic == EMPTY_HSTRING && proto.IsCanUseOnSmth )\r\n        usePic = hstring( \"art/intrface/useon.frm\" );\r\n    if( usePic == EMPTY_HSTRING && proto.IsCanUse )\r\n        usePic = hstring( \"art/intrface/uset.frm\" );\r\n}\r\n\r\nBackgroundImage.Load( usePic );\r\nSetPosition( 180 - BackgroundImage.Size.width, Pos.y );",
                      "Children": []
                    },
                    {
                      "$type": "Panel",
                      "BackgroundImage": "",
                      "BackgroundImageLayout": "None",
                      "CropContent": false,
                      "IsVerticalScroll": false,
                      "IsHorizontalScroll": false,
                      "Expanded": false,
                      "Selected": false,
                      "Active": true,
                      "Name": "ApCost",
                      "Position": "10, 44",
                      "Size": "0, 0",
                      "Anchor": "None",
                      "Dock": "None",
                      "IsDraggable": false,
                      "IsNotHittable": true,
                      "CheckTransparentOnHit": false,
                      "GlobalScope": "",
                      "ClassFields": "",
                      "OnInit": null,
                      "OnShow": null,
                      "OnHide": null,
                      "OnAppear": null,
                      "OnDisappear": null,
                      "OnDraw": null,
                      "OnPostDraw": null,
                      "OnMove": null,
                      "OnMouseDown": null,
                      "OnMouseUp": null,
                      "OnMousePressed": null,
                      "OnLMousePressed": null,
                      "OnRMousePressed": null,
                      "OnMouseClick": null,
                      "OnLMouseClick": null,
                      "OnRMouseClick": null,
                      "OnMouseMove": null,
                      "OnGlobalMouseDown": null,
                      "OnGlobalMouseUp": null,
                      "OnGlobalMousePressed": null,
                      "OnGlobalMouseClick": null,
                      "OnGlobalMouseMove": null,
                      "OnInput": null,
                      "OnGlobalInput": null,
                      "OnActiveChanged": null,
                      "OnFocusChanged": null,
                      "OnHoverChanged": null,
                      "OnDragChanged": null,
                      "OnResizeGrid": null,
                      "OnDrawItem": "int apCost = 0;\r\nif( item !is null && item.Ownership == ItemOwnership::CritterInventory )\r\n{\r\n    apCost = Parameters::GetItemUseApCost( Game.GetCritter( item.CritterId ), item, item.Mode );\r\n}\r\nelse if( item is null )\r\n{\r\n    Critter@ chosen = Game.GetChosen();\r\n    if( chosen !is null )\r\n    {\r\n        auto item2 = CritterItem::GetSlotItemProto( chosen );\r\n        apCost     = Parameters::GetItemUseApCost( chosen, item2, chosen.HandsItemMode );\r\n    }\r\n}\r\n\r\nSetActive( apCost > 0 );\r\nif( apCost > 0 )\r\n    FindText( \"ApCostValue\" ).SetText( \"\" + apCost );",
                      "Children": [
                        {
                          "$type": "Panel",
                          "BackgroundImage": "art/intrface/ap_pic.png",
                          "BackgroundImageLayout": "None",
                          "CropContent": false,
                          "IsVerticalScroll": false,
                          "IsHorizontalScroll": false,
                          "Expanded": false,
                          "Selected": false,
                          "Active": true,
                          "Name": "ApCostImage",
                          "Position": "0, 0",
                          "Size": "17, 12",
                          "Anchor": "None",
                          "Dock": "None",
                          "IsDraggable": false,
                          "IsNotHittable": false,
                          "CheckTransparentOnHit": false,
                          "GlobalScope": null,
                          "ClassFields": null,
                          "OnInit": null,
                          "OnShow": null,
                          "OnHide": null,
                          "OnAppear": null,
                          "OnDisappear": null,
                          "OnDraw": null,
                          "OnPostDraw": null,
                          "OnMove": null,
                          "OnMouseDown": null,
                          "OnMouseUp": null,
                          "OnMousePressed": null,
                          "OnLMousePressed": null,
                          "OnRMousePressed": null,
                          "OnMouseClick": null,
                          "OnLMouseClick": null,
                          "OnRMouseClick": null,
                          "OnMouseMove": null,
                          "OnGlobalMouseDown": null,
                          "OnGlobalMouseUp": null,
                          "OnGlobalMousePressed": null,
                          "OnGlobalMouseClick": null,
                          "OnGlobalMouseMove": null,
                          "OnInput": null,
                          "OnGlobalInput": null,
                          "OnActiveChanged": null,
                          "OnFocusChanged": null,
                          "OnHoverChanged": null,
                          "OnDragChanged": null,
                          "OnResizeGrid": null,
                          "OnDrawItem": null,
                          "Children": []
                        },
                        {
                          "$type": "Text",
                          "Text": null,
                          "DynamicText": null,
                          "Font": "Fonts::SandNum",
                          "VerticalAlignment": "Near",
                          "HorisontalAlignment": "Near",
                          "Align": false,
                          "NoColorize": false,
                          "Bordered": false,
                          "DrawFromBottom": false,
                          "NormalColor": "COLOR_NEUTRAL",
                          "FocusedColor": null,
                          "Expanded": false,
                          "Selected": false,
                          "Active": true,
                          "Name": "ApCostValue",
                          "Position": "20, 0",
                          "Size": "0, 0",
                          "Anchor": "None",
                          "Dock": "None",
                          "IsDraggable": false,
                          "IsNotHittable": false,
                          "CheckTransparentOnHit": false,
                          "GlobalScope": null,
                          "ClassFields": null,
                          "OnInit": null,
                          "OnShow": null,
                          "OnHide": null,
                          "OnAppear": null,
                          "OnDisappear": null,
                          "OnDraw": null,
                          "OnPostDraw": null,
                          "OnMove": null,
                          "OnMouseDown": null,
                          "OnMouseUp": null,
                          "OnMousePressed": null,
                          "OnLMousePressed": null,
                          "OnRMousePressed": null,
                          "OnMouseClick": null,
                          "OnLMouseClick": null,
                          "OnRMouseClick": null,
                          "OnMouseMove": null,
                          "OnGlobalMouseDown": null,
                          "OnGlobalMouseUp": null,
                          "OnGlobalMousePressed": null,
                          "OnGlobalMouseClick": null,
                          "OnGlobalMouseMove": null,
                          "OnInput": null,
                          "OnGlobalInput": null,
                          "OnActiveChanged": null,
                          "OnFocusChanged": null,
                          "OnHoverChanged": null,
                          "OnDragChanged": null,
                          "OnResizeGrid": null,
                          "OnDrawItem": "",
                          "Children": []
                        }
                      ]
                    },
                    {
                      "$type": "Panel",
                      "BackgroundImage": "art/intrface/aim_pic.png",
                      "BackgroundImageLayout": "None",
                      "CropContent": false,
                      "IsVerticalScroll": false,
                      "IsHorizontalScroll": false,
                      "Expanded": false,
                      "Selected": false,
                      "Active": true,
                      "Name": "AimPic",
                      "Position": "162, 41",
                      "Size": "18, 18",
                      "Anchor": "None",
                      "Dock": "None",
                      "IsDraggable": false,
                      "IsNotHittable": true,
                      "CheckTransparentOnHit": false,
                      "GlobalScope": null,
                      "ClassFields": null,
                      "OnInit": null,
                      "OnShow": null,
                      "OnHide": null,
                      "OnAppear": null,
                      "OnDisappear": null,
                      "OnDraw": null,
                      "OnPostDraw": null,
                      "OnMove": null,
                      "OnMouseDown": null,
                      "OnMouseUp": null,
                      "OnMousePressed": null,
                      "OnLMousePressed": null,
                      "OnRMousePressed": null,
                      "OnMouseClick": null,
                      "OnLMouseClick": null,
                      "OnRMouseClick": null,
                      "OnMouseMove": null,
                      "OnGlobalMouseDown": null,
                      "OnGlobalMouseUp": null,
                      "OnGlobalMousePressed": null,
                      "OnGlobalMouseClick": null,
                      "OnGlobalMouseMove": null,
                      "OnInput": null,
                      "OnGlobalInput": null,
                      "OnActiveChanged": null,
                      "OnFocusChanged": null,
                      "OnHoverChanged": null,
                      "OnDragChanged": null,
                      "OnResizeGrid": null,
                      "OnDrawItem": "Critter@ chosen = Game.GetChosen();\r\nuint8 mode = 0;\r\nif( item !is null )\r\n    mode = item.Mode;\r\nelse if( chosen !is null )\r\n    mode = chosen.HandsItemMode;\r\n\r\nBackgroundImage.Hidden = ( _WeaponModeAim( mode ) == HitLocations::LocationNone );",
                      "Children": []
                    },
                    {
                      "$type": "Panel",
                      "BackgroundImage": null,
                      "BackgroundImageLayout": "None",
                      "CropContent": false,
                      "IsVerticalScroll": false,
                      "IsHorizontalScroll": false,
                      "Expanded": false,
                      "Selected": false,
                      "Active": true,
                      "Name": "Indicators",
                      "Position": "197, 0",
                      "Size": "0, 0",
                      "Anchor": "None",
                      "Dock": "None",
                      "IsDraggable": false,
                      "IsNotHittable": false,
                      "CheckTransparentOnHit": false,
                      "GlobalScope": "",
                      "ClassFields": "#define INDICATOR_LINES          ( 0 )\r\n#define INDICATOR_NUMBERS        ( 1 )\r\n#define INDICATOR_BOTH           ( 2 )\r\n#define INDICATOR_CHANGE_TICK    ( 35 )\r\n\r\nvoid DrawIndicator( int[] rect, int[]& points, ucolor color, int cur, int max, nanotime& tick, bool isVertical, bool fromTopOrLeft )\r\n{\r\n    int percent = 0;\r\n    if( max != 0 )\r\n    {\r\n        percent = cur * 100 / max;\r\n        percent = CLAMP( percent, 0, 100 );\r\n    }\r\n\r\n    if( Game.FrameTime >= tick )\r\n    {\r\n        int pointsCount = ( isVertical ? rect[ 3 ] : rect[ 2 ] ) / 2 * percent / 100;\r\n        if( pointsCount == 0 && percent > 0 )\r\n            pointsCount = 1;\r\n\r\n        if( points.length() / 3 != pointsCount )\r\n        {\r\n            if( pointsCount > points.length() / 3 )\r\n                pointsCount = points.length() / 3 + 1;\r\n            else\r\n                pointsCount = points.length() / 3 - 1;\r\n\r\n            points.resize( pointsCount * 3 );\r\n            for( int i = 0; i < pointsCount; i++ )\r\n            {\r\n                int x, y;\r\n                if( isVertical )\r\n                {\r\n                    x = rect[ 0 ];\r\n                    if( fromTopOrLeft )\r\n                        y = rect[ 1 ] + i * 2;\r\n                    else\r\n                        y = rect[ 1 ] + rect[ 3 ] - i * 2;\r\n                }\r\n                else\r\n                {\r\n                    y = rect[ 1 ];\r\n                    if( fromTopOrLeft )\r\n                        x = rect[ 0 ] + i * 2;\r\n                    else\r\n                        x = rect[ 0 ] + rect[ 2 ] - i * 2;\r\n                }\r\n                points[ i * 3 + 0 ] = x;\r\n                points[ i * 3 + 1 ] = y;\r\n                points[ i * 3 + 2 ] = color.value;\r\n            }\r\n        }\r\n        tick = Game.FrameTime + Time::Milliseconds(INDICATOR_CHANGE_TICK);\r\n    }\r\n\r\n    if( points.length() > 0 )\r\n        Game.DrawPrimitive( RenderPrimitiveType::PointList, points );\r\n}",
                      "OnInit": null,
                      "OnShow": null,
                      "OnHide": null,
                      "OnAppear": null,
                      "OnDisappear": null,
                      "OnDraw": null,
                      "OnPostDraw": null,
                      "OnMove": null,
                      "OnMouseDown": null,
                      "OnMouseUp": null,
                      "OnMousePressed": null,
                      "OnLMousePressed": null,
                      "OnRMousePressed": null,
                      "OnMouseClick": null,
                      "OnLMouseClick": null,
                      "OnRMouseClick": null,
                      "OnMouseMove": null,
                      "OnGlobalMouseDown": null,
                      "OnGlobalMouseUp": null,
                      "OnGlobalMousePressed": null,
                      "OnGlobalMouseClick": null,
                      "OnGlobalMouseMove": null,
                      "OnInput": null,
                      "OnGlobalInput": null,
                      "OnActiveChanged": null,
                      "OnFocusChanged": null,
                      "OnHoverChanged": null,
                      "OnDragChanged": null,
                      "OnResizeGrid": null,
                      "OnDrawItem": null,
                      "Children": [
                        {
                          "$type": "Panel",
                          "BackgroundImage": null,
                          "BackgroundImageLayout": "None",
                          "CropContent": false,
                          "IsVerticalScroll": false,
                          "IsHorizontalScroll": false,
                          "Expanded": false,
                          "Selected": false,
                          "Active": true,
                          "Name": "AmmoLine",
                          "Position": "0, 0",
                          "Size": "1, 70",
                          "Anchor": "None",
                          "Dock": "None",
                          "IsDraggable": false,
                          "IsNotHittable": false,
                          "CheckTransparentOnHit": false,
                          "GlobalScope": "",
                          "ClassFields": "int[] Points = {};\r\nnanotime CurTick;",
                          "OnInit": null,
                          "OnShow": null,
                          "OnHide": null,
                          "OnAppear": null,
                          "OnDisappear": null,
                          "OnDraw": "",
                          "OnPostDraw": null,
                          "OnMove": null,
                          "OnMouseDown": null,
                          "OnMouseUp": null,
                          "OnMousePressed": null,
                          "OnLMousePressed": null,
                          "OnRMousePressed": null,
                          "OnMouseClick": null,
                          "OnLMouseClick": null,
                          "OnRMouseClick": null,
                          "OnMouseMove": null,
                          "OnGlobalMouseDown": null,
                          "OnGlobalMouseUp": null,
                          "OnGlobalMousePressed": null,
                          "OnGlobalMouseClick": null,
                          "OnGlobalMouseMove": null,
                          "OnInput": null,
                          "OnGlobalInput": null,
                          "OnActiveChanged": null,
                          "OnFocusChanged": null,
                          "OnHoverChanged": null,
                          "OnDragChanged": null,
                          "OnResizeGrid": null,
                          "OnDrawItem": "if(false)/*if( Settings.IndicatorType != INDICATOR_LINES && Settings.IndicatorType != INDICATOR_BOTH )*/\r\n    return;\r\n\r\nint indicatorMax = 0;\r\nint indicatorCur = 0;\r\n\r\nif( item !is null )\r\n{\r\n    if( item.Type == ItemType::Weapon && item.Weapon_MaxAmmoCount > 0 )\r\n    {\r\n        indicatorMax = item.Weapon_MaxAmmoCount;\r\n        indicatorCur = item.AmmoCount;\r\n    }\r\n    else\r\n    {\r\n        indicatorMax = item.IndicatorMax;\r\n        indicatorCur = item.Indicator;\r\n    }\r\n}\r\n\r\nint[] rect = { AbsolutePos.x, AbsolutePos.y, Size.width, Size.height };\r\ncast< Indicators >( Parent ).DrawIndicator( rect, Points, COLOR_GREEN, indicatorCur, indicatorMax, CurTick, true, false );",
                          "Children": []
                        },
                        {
                          "$type": "Panel",
                          "BackgroundImage": null,
                          "BackgroundImageLayout": "None",
                          "CropContent": false,
                          "IsVerticalScroll": false,
                          "IsHorizontalScroll": false,
                          "Expanded": false,
                          "Selected": false,
                          "Active": true,
                          "Name": "DeteriorationLine",
                          "Position": "3, 0",
                          "Size": "1, 70",
                          "Anchor": "None",
                          "Dock": "None",
                          "IsDraggable": false,
                          "IsNotHittable": false,
                          "CheckTransparentOnHit": false,
                          "GlobalScope": null,
                          "ClassFields": "int[] Points = {};\r\nnanotime CurTick;",
                          "OnInit": null,
                          "OnShow": null,
                          "OnHide": null,
                          "OnAppear": null,
                          "OnDisappear": null,
                          "OnDraw": null,
                          "OnPostDraw": null,
                          "OnMove": null,
                          "OnMouseDown": null,
                          "OnMouseUp": null,
                          "OnMousePressed": null,
                          "OnLMousePressed": null,
                          "OnRMousePressed": null,
                          "OnMouseClick": null,
                          "OnLMouseClick": null,
                          "OnRMouseClick": null,
                          "OnMouseMove": null,
                          "OnGlobalMouseDown": null,
                          "OnGlobalMouseUp": null,
                          "OnGlobalMousePressed": null,
                          "OnGlobalMouseClick": null,
                          "OnGlobalMouseMove": null,
                          "OnInput": null,
                          "OnGlobalInput": null,
                          "OnActiveChanged": null,
                          "OnFocusChanged": null,
                          "OnHoverChanged": null,
                          "OnDragChanged": null,
                          "OnResizeGrid": null,
                          "OnDrawItem": "if(false)/*if( Settings.IndicatorType != INDICATOR_LINES && Settings.IndicatorType != INDICATOR_BOTH )*/\r\n    return;\r\n\r\nint indicatorMax = 0;\r\nint indicatorCur = 0;\r\n\r\nif( item !is null && item.Deteriorable )\r\n{\r\n    indicatorMax = Tla::MaxDeterioration;\r\n    indicatorCur = item.Deterioration;\r\n}\r\n\r\nint[] rect = { AbsolutePos.x, AbsolutePos.y, Size.width, Size.height };\r\ncast< Indicators >( Parent ).DrawIndicator( rect, Points, COLOR_RED, indicatorCur, indicatorMax, CurTick, true, false );",
                          "Children": []
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        }
      ]
    }
  ]
}