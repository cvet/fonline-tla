namespace GuiScreensExt // Sort 2
{

#if CLIENT

void TryExit()
{
    Gui::Screen screen = Gui::GetActiveScreen();

    switch (screen.Num) {
    case GuiScreen::None:
        break;

    case GuiScreen::Login:
        Game.RequestQuit();
        break;
    case GuiScreen::Registration:
        Gui::ShowScreen(GuiScreen::Login);
        break;
    case GuiScreen::Wait:
        Game.Disconnect();
        break;
    case GuiScreen::GlobalMap:
    case GuiScreen::Game:
        if (Settings.Cursor == CursorType::UseItem || Settings.Cursor == CursorType::UseWeapon || Settings.Cursor == CursorType::UseSkill) {
            Settings.Cursor = CursorType::Default;
        }
        else {
            Gui::ShowScreen(GuiScreen::Menu);
        }
        break;

    default:
        if (!IsMainScreen(screen)) {
            Gui::HideScreen(screen);
        }
        break;
    }
}

bool IsMainScreen(Gui::Screen screen)
{
    GuiScreen num = screen.Num;
    return num == GuiScreen::Login || num == GuiScreen::Registration || num == GuiScreen::Game || num == GuiScreen::GlobalMap || num == GuiScreen::Wait;
}

void NextCursor()
{
    switch (Settings.Cursor) {
    case CursorType::Default:
        Settings.Cursor = CursorType::Move;
        break;
    case CursorType::Move: {
        Critter chosen = Game.GetChosen();
        if (chosen != null && !IS_TIMEOUT(chosen.TimeoutBattle) && CritterItem::GetActive(chosen).Type == ItemType::Weapon) {
            Settings.Cursor = CursorType::UseWeapon;
        }
        else {
            Settings.Cursor = CursorType::Default;
        }
    } break;
    case CursorType::UseItem:
        Settings.Cursor = CursorType::Default;
        break;
    case CursorType::UseWeapon:
        Settings.Cursor = CursorType::Default;
        break;
    case CursorType::UseSkill:
        Settings.Cursor = CursorType::Move;
        break;
    default:
        Settings.Cursor = CursorType::Default;
        break;
    }
}

#endif

}
